<?php
 namespace app\index\logic; use think\Db; class UserRecord extends Base { public function setRecordUsers($module, $record_id, $user_ids, $primary_users = null) { goto jI3XT; UnItP: $adds = []; goto FotUK; g2EbE: if (is_array($user_ids)) { goto EQkjE; } goto Rd3SA; jk2nJ: foreach ($user_ids as $uid) { $adds[] = ["\155\157\144\x75\x6c\x65" => $module, "\162\145\x63\x6f\x72\x64\137\x69\x64" => $record_id, "\x75\x73\x65\162\x5f\151\144" => $uid, "\x70\x72\x69\x6d\141\x72\x79" => $primary_users && in_array($uid, $primary_users) ? 1 : 0]; iYo20: } goto DRX0j; ms9zk: return; goto cvgWj; B6a0x: $primary_users = explode("\54", $primary_users); goto RMw5n; cvgWj: VyC_I: goto g2EbE; wRJUG: if (!($primary_users && !is_array($primary_users))) { goto AH2R8; } goto B6a0x; YZl5t: if (!empty($user_ids)) { goto VyC_I; } goto ms9zk; jI3XT: Db::table("\165\x73\x65\162\x73\x5f\162\145\x63\x6f\162\x64\163")->where(["\155\x6f\144\165\x6c\145" => $module, "\x75\x73\145\162\x5f\x69\144" => ["\x67\164", 0], "\x72\145\143\x6f\162\144\x5f\151\144" => $record_id])->delete(); goto YZl5t; Rd3SA: $user_ids = explode("\54", $user_ids); goto TINxh; DRX0j: C8nLV: goto SXstD; SXstD: Db::table("\x75\x73\145\x72\163\137\162\x65\143\x6f\162\144\163")->insertAll($adds); goto QMoHA; TINxh: EQkjE: goto wRJUG; RMw5n: AH2R8: goto UnItP; FotUK: $user_ids = array_unique($user_ids); goto jk2nJ; QMoHA: } public function getRecordUsers($module, $record_id) { $users = Db::table("\165\x73\x65\x72\x73\137\162\x65\x63\157\162\144\x73")->where(["\155\157\144\x75\154\145" => $module, "\x72\145\143\x6f\x72\x64\137\x69\x64" => $record_id])->column("\x72\145\143\157\x72\x64\137\x69\144\x2c\x75\x73\145\x72\x5f\151\144\54\160\x72\151\x6d\141\162\x79", "\165\163\145\162\x5f\151\144"); return $users; } }
