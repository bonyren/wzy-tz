<?php
 namespace app\index\logic; use app\index\model\Extras; class Extra extends Base { private $model; protected function __construct() { parent::__construct(); $this->model = new Extras(); } public function setValue($module, $record_id, $key, $value = null) { goto fdsCY; d41PO: ded1O: goto ZFo1M; ZFo1M: foreach ($data as $k => $v) { goto vW8_p; BFDYT: Extras::where("\151\144", $id)->update(["\x76\x61\x6c\165\x65" => $v, "\x69\163\137\152\x73\157\x6e" => $is_json]); goto pMUMU; ctQ01: $extra->save(); goto Txlfz; vW8_p: $id = Extras::get(["\155\157\x64\165\154\145" => $module, "\162\x65\143\x6f\x72\x64\x5f\x69\x64" => $record_id, "\x6b\x65\171" => $k])->id; goto yrE0Y; ZvGab: VG8je: goto VMs7U; g0JRH: iBr6r: goto lDJ7H; ILJVO: goto vJq7v; goto pIwNq; Txlfz: vJq7v: goto ZvGab; lDJ7H: $is_json = 1; goto ifvDy; OwkYU: if ($v !== '') { goto aUsHP; } goto ILJVO; STl7S: $v = trim($v); goto NPncp; pIwNq: pVotH: goto Twu3N; NPncp: goto OlEgV; goto g0JRH; fh78c: OlEgV: goto en3Hx; VwVS4: fbkCk: goto xHFrq; yrE0Y: if (is_array($v)) { goto iBr6r; } goto K01NW; T0brD: aUsHP: goto C1n0m; m3DtQ: BC3fW: goto P1b55; C1n0m: $extra = new Extras(["\x6d\157\144\165\154\x65" => $module, "\162\145\x63\x6f\x72\x64\x5f\151\144" => $record_id, "\153\145\x79" => $k, "\166\x61\x6c\165\x65" => $v, "\151\x73\137\x6a\x73\157\156" => $is_json]); goto ctQ01; P1b55: Extras::destroy($id); goto VwVS4; pMUMU: goto fbkCk; goto m3DtQ; xHFrq: goto vJq7v; goto T0brD; en3Hx: if ($id) { goto pVotH; } goto OwkYU; ifvDy: $v = json_encode($v, JSON_UNESCAPED_UNICODE); goto fh78c; K01NW: $is_json = 0; goto STl7S; Twu3N: if ($v === '') { goto BC3fW; } goto BFDYT; VMs7U: } goto dgKTk; Sobuz: return true; goto OYC1u; fdsCY: $data = is_null($value) ? $key : [$key => $value]; goto LdbqY; LdbqY: if (!empty($data)) { goto U9igr; } goto b10DL; b10DL: return false; goto q5IdF; dgKTk: aBw7y: goto Sobuz; q5IdF: U9igr: goto Dv8O2; NetVO: return false; goto d41PO; Dv8O2: if (is_array($data)) { goto ded1O; } goto NetVO; OYC1u: } public function getValue($module, $record_id, $key = '') { goto F6S9t; nxdaD: if (!$key) { goto DMW6e; } goto zOa2e; zOa2e: $map["\x6b\x65\x79"] = $key; goto fWt54; vmfVp: if (!empty($data)) { goto BPMJG; } goto K9jnQ; Zgg_U: BPMJG: goto vyaoF; zg4uF: return $data; goto d3GQu; K9jnQ: return []; goto Zgg_U; E47rr: if (!$key) { goto rclZT; } goto lONrA; lONrA: $data = $data[$key]; goto pef9F; fWt54: DMW6e: goto ud9Nx; ud9Nx: $data = Extras::where($map)->column("\x6b\x65\171\54\166\x61\154\165\145\x2c\151\x73\137\x6a\x73\x6f\156", "\153\145\x79"); goto vmfVp; pef9F: rclZT: goto zg4uF; vyaoF: foreach ($data as $k => $v) { goto m9j4W; kB98E: eMM4i: goto mDNap; m9j4W: if (!$v["\151\163\137\x6a\x73\157\156"]) { goto eMM4i; } goto dQwXT; mDNap: $data[$k] = $v["\166\141\x6c\x75\145"]; goto Ipimk; dQwXT: $v["\166\141\154\x75\x65"] = json_decode($v["\166\141\154\165\145"], true); goto kB98E; Ipimk: m3sZn: goto ZvEwj; ZvEwj: } goto gqQln; F6S9t: $map = ["\155\x6f\144\165\x6c\145" => $module, "\162\145\143\x6f\x72\144\x5f\x69\x64" => $record_id]; goto nxdaD; gqQln: bDK7Y: goto E47rr; d3GQu: } public function removeKey($module, $record_id, $key) { Extras::where(["\155\157\x64\x75\x6c\145" => $module, "\162\x65\x63\157\x72\144\x5f\x69\x64" => $record_id, "\x6b\145\x79" => $key])->delete(); } }
