<?php
 namespace app\index\controller; use app\index\logic\Enterprise; use app\index\logic\Industry; use think\Db; class Industries extends Common { public function index($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS) { goto np3Oe; oF6qW: $data = Industry::I()->load($search, $page, $rows); goto M5JQW; np3Oe: if (!$this->request->isGet()) { goto W_Ed8; } goto ejzhf; FUFuw: return $this->fetch(); goto VyeHo; ejzhf: $urls = ["\x6c\151\163\164" => url("\151\156\x64\145\170\x2f\111\156\x64\x75\163\x74\162\x69\x65\x73\x2f\x69\x6e\x64\145\x78"), "\141\164\x74\141\143\x68\145\x73" => url("\151\156\144\x65\x78\x2f\125\x70\x6c\x6f\141\x64\57\x76\151\145\x77\101\164\164\x61\143\x68\x65\x73", ["\x61\164\x74\141\x63\150\x6d\x65\x6e\x74\124\171\160\x65" => 2, "\x75\151\123\164\x79\x6c\145" => Upload::ATTACHES_UI_TABLE_STYLE]), "\x65\144\x69\164" => url("\151\156\x64\145\170\x2f\x49\156\x64\x75\163\x74\x72\x69\x65\163\57\x65\x64\x69\164"), "\144\x65\x6c\145\x74\x65" => url("\x69\156\x64\145\170\x2f\111\156\x64\x75\163\164\x72\151\x65\163\x2f\144\x65\x6c\145\164\x65")]; goto eTwDG; VyeHo: W_Ed8: goto oF6qW; eTwDG: $this->assign("\x75\162\154\163", $urls); goto FUFuw; M5JQW: return json($data); goto eaMp4; eaMp4: } public function edit($id = 0) { goto ahtYB; eubOz: $this->assign("\x72\x6f\x77", $row); goto i585t; oE4AG: try { Industry::I()->saveRow($id, $data); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto kV42O; uRZNz: $row = Industry::I()->getRow($id); goto d0K3z; kV42O: return ajaxSuccess("\344\277\235\xe5\xad\230\xe6\x88\x90\345\212\237"); goto UZs2g; i585t: return $this->fetch(); goto ZO591; d0K3z: if ($row) { goto hUi40; } goto mAuZe; tW5KH: $data = $data["\144\x61\x74\141"]; goto oE4AG; aNp2g: $data = input("\x70\x6f\163\164\56"); goto tW5KH; ahtYB: if (!$this->request->isGet()) { goto NhOYd; } goto uRZNz; ZO591: NhOYd: goto aNp2g; mAuZe: $row = Industry::I()->getDefaultRow(); goto ry0pV; ry0pV: hUi40: goto eubOz; UZs2g: } public function delete($id) { try { Industry::I()->delete($id); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\xe5\210\xa0\xe9\x99\xa4\346\210\220\345\x8a\237"); } public function attachments($record_id, $attach_type, $read_only = 0) { goto Zm5n0; bx09L: $urls = ["\141\x74\164\141\143\x68\155\145\156\x74\x73" => $attachesUrl]; goto aRNjM; auNbG: ZXbsz: goto bx09L; Zm5n0: if ($read_only) { goto Y0S2y; } goto TpMW2; tW3_A: Y0S2y: goto IXZuW; X0WNr: return $this->fetch(); goto TmkiL; kQlKx: $this->assign("\145\170\x74\x65\x72\156\x61\154\111\x64", $record_id); goto X0WNr; dJRwU: $this->assign("\x61\x74\164\x61\x63\150\x6d\x65\156\164\124\x79\x70\145", $attach_type); goto kQlKx; aLYJ5: goto ZXbsz; goto tW3_A; aRNjM: $this->assign("\165\162\154\163", $urls); goto dJRwU; IXZuW: $attachesUrl = url("\x69\156\x64\x65\170\x2f\125\160\x6c\x6f\x61\x64\x2f\166\151\145\x77\x41\x74\164\x61\143\x68\145\x73", ["\x61\x74\164\141\x63\150\x6d\x65\x6e\x74\124\x79\160\145" => $attach_type, "\145\x78\x74\x65\162\156\x61\x6c\111\144" => $record_id, "\165\x69\x53\164\x79\154\145" => Upload::ATTACHES_UI_LIGHT_STYLE]); goto auNbG; TpMW2: $attachesUrl = url("\151\156\144\x65\170\x2f\125\160\154\x6f\141\144\57\141\x74\x74\141\143\150\x65\x73", ["\141\164\164\x61\143\150\x6d\145\156\164\x54\171\x70\x65" => $attach_type, "\x65\170\164\145\x72\156\141\x6c\111\144" => $record_id, "\x75\x69\123\x74\171\154\x65" => Upload::ATTACHES_UI_LIGHT_STYLE]); goto aLYJ5; TmkiL: } public function graphs($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS) { goto iv8qc; KbqUT: $where = ["\x64\145\154\x65\164\145\144" => 0]; goto I6O03; OKadm: return json($data); goto c3wgj; EOMA0: return json($data); goto NO1TY; YIk_d: TpfTD: goto SkmYC; I6O03: $total = Db::table("\x69\156\144\x75\x73\x74\x72\171\x5f\147\162\141\160\x68\x73")->where($where)->count(); goto DG85l; SkmYC: $data = ["\x74\157\x74\x61\154" => 0, "\162\x6f\167\163" => []]; goto KbqUT; C0SvN: return $this->fetch(); goto YIk_d; QlzxM: $data["\x74\157\x74\x61\154"] = $total; goto qqf8p; c3wgj: y6hHz: goto QlzxM; iv8qc: if (!$this->request->isGet()) { goto TpfTD; } goto C0SvN; qqf8p: $data["\x72\x6f\167\x73"] = Db::table("\x69\156\144\x75\x73\x74\x72\171\x5f\x67\162\x61\160\150\x73")->field("\x69\144\54\156\141\155\145\x2c\x64\141\164\x65\137\145\x6e\x74\145\x72\145\x64")->where($where)->select(); goto EOMA0; DG85l: if (!empty($total)) { goto y6hHz; } goto OKadm; NO1TY: } public function viewGraph($id) { goto bgOIx; c9Uzy: $this->assign("\x72\157\x77", $row); goto S7Ome; j20KL: return $this->fetch(); goto S13x7; ghCW2: $data = []; goto OndDV; OndDV: foreach ($rows as $v) { $data[] = ["\x78" => mt_rand(50, 100), "\171" => mt_rand(50, 100), "\172" => mt_rand(10, 40), "\x6e\x61\x6d\145" => $v["\156\141\155\145"], "\146\x75\x6c\x6c\137\156\x61\x6d\x65" => $v["\156\x61\x6d\x65"]]; ikvAU: } goto rgZqa; S7Ome: $this->assign("\x64\141\x74\x61", json_encode($data, JSON_UNESCAPED_UNICODE)); goto j20KL; bgOIx: $row = Db::table("\151\156\x64\165\x73\164\162\x79\137\147\x72\141\x70\150\x73")->where("\151\144", $id)->find(); goto fNiaM; fNiaM: $rows = Db::table("\145\156\164\x65\162\160\x72\x69\163\x65\163")->field("\151\144\x2c\156\x61\x6d\145")->where("\x73\164\x65\160", "\145\147\x74", 3)->select(); goto ghCW2; rgZqa: rqBeh: goto c9Uzy; S13x7: } public function editGraph($id = 0) { goto y1Zbt; RDJpM: $row = Db::table("\151\156\x64\165\163\x74\x72\171\137\147\x72\x61\160\x68\163")->where("\x69\144", $id)->find(); goto nCptr; meSbH: $data = input("\160\x6f\163\x74\56\x64\x61\x74\141\x2f\x61"); goto w___l; WroMG: zs50x: goto meSbH; w___l: try { goto afvp1; afvp1: if ($id) { goto Ab3p0; } goto EGM2y; M5YBE: LbShn: goto apfJk; EGM2y: Db::table("\x69\x6e\144\165\x73\x74\162\x79\137\x67\x72\141\x70\x68\163")->insert($data); goto M6i0K; M6i0K: goto LbShn; goto DqxBO; DqxBO: Ab3p0: goto Z4Kgd; Z4Kgd: $data["\x63\x72\x65\x61\164\145\144\x5f\x62\x79"] = $this->loginUserId; goto obD_1; obD_1: Db::table("\x69\156\x64\x75\x73\x74\x72\171\x5f\147\x72\x61\160\x68\x73")->where("\x69\144", $id)->update($data); goto M5YBE; apfJk: } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto tNktn; tNktn: return ajaxSuccess("\344\xbf\x9d\345\xad\x98\xe6\x88\220\345\212\237"); goto HComz; xMzNs: return $this->fetch(); goto WroMG; nCptr: $this->assign("\x72\x6f\x77", $row); goto xMzNs; y1Zbt: if (!$this->request->isGet()) { goto zs50x; } goto RDJpM; HComz: } public function deleteGraph($id) { Db::table("\x69\156\144\165\163\x74\162\171\137\x67\x72\141\160\x68\x73")->where("\x69\x64", $id)->setField("\144\145\154\x65\x74\x65\144", 1); return ajaxSuccess("\xe5\210\xa0\351\x99\xa4\xe6\210\x90\345\212\x9f"); } }
