<?php
 namespace app\index\controller; use app\index\logic\Extra; use app\index\logic\Meeting; use app\index\model\Dropdowns; use think\Db; use app\index\logic\Enterprise as EnterpriseLogic; use app\index\logic\Defs as IndexDefs; class Investment extends Common { public function invested($enterprise_id, $readonly = 1) { goto Uf7hr; kl4yB: $this->assign("\145\x6e\164\145\x72\x70\162\x69\163\x65\x5f\151\x64", $enterprise_id); goto X0LoU; dVC17: $stages = Dropdowns::getItems("\146\151\156\x61\x6e\x63\151\x6e\147\x5f\163\164\141\x67\x65", true); goto MQIzh; sExji: $this->assign("\x72\x6f\x77\163", $rows); goto TpTyi; MQIzh: $rows = array_map(function ($v) use($stages) { $v["\164\x69\164\154\145"] = $v["\x66\151\156\x61\156\143\x69\x6e\147\x5f\163\164\x61\147\145"] ? $stages[$v["\x66\151\x6e\x61\156\x63\x69\156\147\137\x73\x74\141\147\145"]] : "\346\234\252\xe6\x8c\207\345\256\232\xe8\275\xae\346\254\241"; return $v; }, $rows); goto lM4eV; d5Tw6: Dov2H: goto sExji; scDpj: $rows = []; goto d5Tw6; TpTyi: $this->assign("\x72\x65\x61\144\157\156\x6c\x79", $readonly); goto kl4yB; L5Vy_: WEq7x: goto scDpj; MWrLB: if (empty($rows)) { goto WEq7x; } goto dVC17; lM4eV: goto Dov2H; goto L5Vy_; X0LoU: return $this->fetch(); goto nNhmy; Uf7hr: $rows = Db::table("\151\156\x76\x65\163\164\155\x65\156\x74")->field("\x69\144\x2c\146\x69\156\x61\156\x63\x69\x6e\147\137\x73\x74\141\x67\145")->where(["\x65\156\164\145\x72\160\x72\x69\163\x65\x5f\151\144" => $enterprise_id])->order("\151\144\40\x64\x65\x73\x63")->select(); goto MWrLB; nNhmy: } public function getPendingRow($enterprise_id) { $id = Db::table("\x69\x6e\x76\145\163\x74\155\x65\156\x74")->where(["\145\156\x74\x65\162\160\162\151\163\145\x5f\x69\144" => $enterprise_id, "\163\164\x61\x74\165\163" => IndexDefs::INVESTMENT_PENDING_STATUS])->order("\151\144\x20\144\x65\x73\x63")->value("\x69\x64"); return intval($id); } public function add($enterprise_id = 0, $id = 0) { goto w8JxQ; q16_c: return $this->fetch(); goto r5MPO; hnGtO: if (!($e["\163\164\145\x70"] == EnterpriseLogic::STEP_INVESTING)) { goto baUpZ; } goto KIqqP; ltMvP: $data["\x65\x6e\164\145\x72\x70\x72\151\163\145\x5f\x69\144"] = $enterprise_id; goto cdOEE; CouoZ: Pkh77: goto XYCh7; gxDZO: $extra = input("\160\x6f\163\164\x2e\x65\170\x74\162\141\x2f\141"); goto VbmEy; Ydrk2: goto zAB3B; goto su2fX; b6D7A: return ajaxSuccess("\344\xbf\235\xe5\255\x98\xe6\x88\x90\345\x8a\237", $id); goto e3GpG; VbmEy: if (!$extra) { goto VqCJN; } goto oEKXi; TNlS8: VqCJN: goto b6D7A; w8JxQ: if (!$this->request->isGet()) { goto NaOvu; } goto q16_c; bPimA: baUpZ: goto FZP2C; KIqqP: $meeting_id = Db::table("\155\145\x65\x74\151\x6e\147\x73")->where(["\x74\x79\x70\145" => Meeting::MEETING_INVEST_DECISION_TYPE, "\x72\145\x6c\141\x74\145\137\x69\x64" => $enterprise_id, "\151\156\x76\x65\163\x74\155\145\x6e\x74\x5f\x69\144" => 0])->order("\x69\144\40\104\105\123\x43")->value("\x69\144"); goto wAIXN; cdOEE: $id = Db::table("\151\156\166\x65\163\x74\155\x65\x6e\164")->insertGetId($data); goto TB0ik; TB0ik: if (!$data["\x6d\145\x65\x74\x69\x6e\147\x5f\151\x64"]) { goto P018n; } goto KfYGv; KfYGv: Db::table("\x6d\x65\x65\x74\151\x6e\x67\x73")->where(["\151\x64" => $data["\x6d\x65\x65\x74\x69\156\x67\x5f\151\144"]])->setField("\151\x6e\166\145\163\164\x6d\145\156\164\x5f\x69\x64", $id); goto XJ3vx; r5MPO: NaOvu: goto wIBly; dOnJE: $data["\x64\151\x72\145\143\164\x6f\162"] = ''; goto CouoZ; T9Ibf: $e = Db::table("\x65\156\x74\145\x72\x70\162\x69\x73\x65\x73")->field("\163\164\x65\x70\54\x73\x74\145\x70\137\163\x74\141\x74\145")->where("\x69\144", $enterprise_id)->find(); goto hnGtO; XYCh7: if (empty($id)) { goto G6We5; } goto U6uQx; U6uQx: Db::table("\x69\x6e\166\x65\163\164\x6d\145\x6e\x74")->where("\x69\x64", $id)->update($data); goto Ydrk2; wAIXN: if (!$meeting_id) { goto W3cZA; } goto d9mKl; d9mKl: $data["\x6d\145\145\x74\x69\156\x67\137\151\x64"] = $meeting_id; goto nZae1; nZae1: W3cZA: goto bPimA; GvV3e: zAB3B: goto gxDZO; XJ3vx: P018n: goto GvV3e; wIBly: $data = input("\160\x6f\x73\x74\x2e\x64\x61\164\141\57\141"); goto W8Pwi; FZP2C: $data["\x73\x74\141\164\x75\163"] = IndexDefs::INVESTMENT_PENDING_STATUS; goto ltMvP; oEKXi: Extra::I()->setValue("\x49\156\x76\x65\x73\164\x6d\145\x6e\164", $id, $extra); goto TNlS8; su2fX: G6We5: goto T9Ibf; W8Pwi: if (isset($data["\144\x69\162\x65\x63\x74\157\162"])) { goto Pkh77; } goto dOnJE; e3GpG: } public function remove($id) { goto B1Q3U; UtVAt: ATESa: goto pN0wU; B1Q3U: $row = Db::table("\x69\x6e\166\145\x73\164\155\145\x6e\x74")->where("\x69\144", $id)->find(); goto phKV1; Vo5CV: return ajaxError("\xe6\227\xa0\xe6\263\x95\346\211\xbe\345\x88\xb0\xe8\xaf\xa5\xe6\x8a\x95\xe8\265\204\344\272\xa4\345\211\262"); goto K6tLa; wuSus: Db::table("\x69\156\166\x65\x73\164\x6d\x65\x6e\164")->where("\151\144", $id)->delete(); goto azaaW; phKV1: if (!empty($row)) { goto rWR6i; } goto Vo5CV; AUPyq: return ajaxSuccess("\345\x88\240\351\x99\244\346\x88\220\345\x8a\237"); goto KVT7v; PDuMY: Db::query($sql, [$id]); goto AUPyq; pN0wU: $sql = "\40\x20\x20\40\144\x65\154\145\x74\145\x20\146\x65\x2c\146\146\x65\x20\146\162\157\155\40\x66\x75\x6e\144\x73\x5f\145\156\164\x65\x72\160\x72\x69\163\x65\163\40\x66\x65\x20\151\x6e\x6e\x65\162\40\152\157\151\156\x20\146\165\x6e\x64\163\137\146\x69\156\141\x6e\x63\145\137\145\156\x74\145\x72\x70\x72\151\x73\x65\x73\40\x66\146\145\40\157\156\x20\x66\145\56\140\146\146\x65\137\151\144\x60\75\x66\x66\x65\x2e\x60\146\x66\145\x5f\x69\144\x60\40\xd\xa\40\x20\x20\40\x77\x68\145\x72\x65\x20\x66\x65\x2e\140\x69\156\x76\145\163\x74\x6d\x65\x6e\x74\x5f\x69\144\x60\x3d\77"; goto PDuMY; azaaW: if (!$row["\155\145\x65\164\151\156\147\x5f\x69\x64"]) { goto ATESa; } goto LvJAh; K6tLa: rWR6i: goto wuSus; LvJAh: Db::table("\x6d\145\x65\x74\x69\156\x67\163")->where(["\151\x64" => $row["\x6d\145\x65\x74\151\156\147\x5f\x69\144"]])->setField("\151\x6e\166\145\x73\x74\155\x65\156\164\137\151\x64", 0); goto UtVAt; KVT7v: } public function delivery($id, $readonly = 0) { goto aB0l9; q03HT: $this->assign("\x75\163\x65\x72\x73", \app\index\logic\Admins::I()->getAllUsers()); goto wbZbx; Csb8K: $this->assign("\162\x6f\167", $row); goto q03HT; aB0l9: $row = Db::table("\151\156\166\x65\163\164\x6d\145\x6e\x74")->where("\x69\144", $id)->find(); goto Csb8K; lsN4E: return $this->fetch(); goto O6XgM; wbZbx: $this->assign("\145\x6e\x74\145\162\160\x72\x69\163\145\x5f\x69\144", $row["\145\x6e\164\145\x72\x70\x72\151\x73\145\137\x69\x64"]); goto yi8sC; xOKi3: $this->assign("\141\164\164\141\143\150\x65\163", $readonly ? "\x76\x69\x65\167\x41\164\x74\141\143\x68\145\x73" : "\x61\164\164\141\143\150\x65\163"); goto lsN4E; yi8sC: $this->assign("\162\145\x61\x64\x6f\156\x6c\171", $row["\x73\164\141\164\165\163"] < 0 ? 1 : intval($readonly)); goto xOKi3; O6XgM: } public function basic($id, $readonly = 0) { goto bi_Ll; EuOm7: $row["\145\x78\164\162\x61\x5f\163\160\x65\143\151\141\x6c\x5f\164\145\162\155\x73"] = array_merge(["\x72\151\147\150\x74\163" => [], "\x64\x65\x73\143" => ''], Extra::I()->getValue("\x49\x6e\166\x65\x73\164\x6d\145\x6e\164", $id, "\163\x70\x65\x63\151\141\154\137\164\145\162\155\163")); goto V78lf; f8eEX: $this->assign("\145\x6e\x74\x65\x72\x70\x72\151\x73\x65\x5f\151\x64", $row["\x65\x6e\164\x65\x72\x70\x72\x69\x73\x65\137\151\x64"]); goto qQ90c; qQ90c: $this->assign("\162\x65\141\x64\157\x6e\154\x79", intval($readonly)); goto TQr1T; TQr1T: return $this->fetch(); goto h9EtZ; H60NE: $this->assign("\165\163\x65\162\x73", \app\index\logic\Admins::I()->getAllUsers()); goto f8eEX; bi_Ll: $row = Db::table("\151\x6e\166\x65\163\164\x6d\x65\156\164")->where("\x69\x64", $id)->find(); goto EuOm7; V78lf: $this->assign("\162\x6f\167", $row); goto H60NE; h9EtZ: } }
