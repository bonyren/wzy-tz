<?php
 namespace app\index\controller; use app\index\logic\Upload; use app\index\logic\Contact; use app\index\logic\Enterprise; use app\index\model\EFounders; class Contacts extends Common { public function index($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS) { goto zKF_B; jY1Kp: foreach ($data["\x72\x6f\x77\163"] as $v) { goto PpTWG; gMmuV: $enterprise_ids[] = $v["\145\x6e\x74\145\162\x70\x72\x69\163\x65\137\x69\x64"]; goto VBeCI; PpTWG: if (!$v["\x65\156\164\x65\162\x70\x72\151\x73\145\x5f\x69\x64"]) { goto hIJGy; } goto gMmuV; kdBrh: siCHo: goto IsrQN; VBeCI: hIJGy: goto kdBrh; IsrQN: } goto mFzuz; Ji2V2: return json(["\x72\x6f\167\163" => [], "\164\157\x74\141\154" => 0]); goto Qpno5; sXBAu: if (!empty($data)) { goto HKruR; } goto Ji2V2; JJlhz: $enterprise_ids = []; goto jY1Kp; wv9b7: return $this->fetch(); goto hl_aD; hl_aD: w0z0R: goto K70or; K70or: $data = Contact::I()->load($search, $page, $rows); goto sXBAu; yqzpz: $urls = ["\x6c\151\x73\x74" => url("\151\x6e\x64\145\x78\x2f\103\x6f\156\164\x61\x63\164\163\x2f\x69\x6e\144\x65\170"), "\x65\144\x69\164" => url("\151\x6e\x64\x65\170\x2f\103\157\156\x74\x61\143\x74\x73\57\145\144\151\x74"), "\x64\x65\x6c\145\x74\145" => url("\x69\x6e\144\145\170\57\x43\157\x6e\x74\141\x63\164\x73\x2f\x64\x65\154\x65\x74\x65"), "\x73\x68\x6f\x77\x5f\x74\x61\147\x73" => url("\x74\x61\147\163\57\x73\x68\157\167\x54\x61\x67\x73\x42\141\x74\x63\x68", ["\143\x61\x74\145\x67\x6f\162\171" => 4])]; goto q7JNN; Qpno5: HKruR: goto JJlhz; mFzuz: HVwDX: goto XqdHr; zKF_B: if (!$this->request->isGet()) { goto w0z0R; } goto yqzpz; zEdqH: return json($data); goto Q752k; q7JNN: $this->assign("\165\x72\x6c\163", $urls); goto wv9b7; XqdHr: $data["\x65\x6e\x74\x65\162\160\x72\151\x73\145"] = Enterprise::I()->getEnterprisePairs($enterprise_ids); goto zEdqH; Q752k: } public function edit($id = 0, $enterprise_id = 0) { goto gT4I8; gT4I8: if (!$this->request->isGet()) { goto eHZSL; } goto lJicb; tCP0f: eHZSL: goto qO5A7; qO5A7: $data = input("\160\157\x73\164\x2e"); goto Kw8NW; Kw8NW: try { goto eS2_F; b2NGG: pY6pR: goto KBqEf; wx5TH: if (!(empty($id) && $enterprise_id)) { goto pY6pR; } goto B_MkJ; B_MkJ: Enterprise::I()->setEnterpriseFounders($enterprise_id, $contact_id); goto b2NGG; eS2_F: $contact_id = Contact::I()->saveContact($id, $data); goto wx5TH; KBqEf: } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto JfAlu; JfAlu: if (empty($data["\160\145\156\144\x69\156\x67\137\x66\151\x6c\x65\x73"])) { goto QcgT3; } goto ECbsA; xkkog: QcgT3: goto WaHoq; ECbsA: Upload::I()->relateAttaches($data["\160\145\156\x64\151\x6e\x67\137\x66\151\x6c\145\x73"], $contact_id); goto xkkog; H3wOA: return $this->fetch(); goto tCP0f; WaHoq: return ajaxSuccess("\344\277\235\345\xad\x98\346\x88\220\xe5\x8a\x9f"); goto nCF15; lJicb: $row = $id ? Contact::I()->getContact($id) : []; goto je2y3; je2y3: $this->assign(["\162\157\167" => $row, "\x75\x73\x65\162\x73" => \app\index\logic\Admins::I()->getAllUsers()]); goto H3wOA; nCF15: } public function delete($id) { try { Contact::I()->delete($id); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\xe5\210\xa0\351\231\244\346\x88\220\xe5\212\237"); } public function view($id) { goto njv5j; CihHb: return "\350\256\260\xe5\xbd\225\344\270\x8d\345\xad\x98\345\x9c\250"; goto g16tg; VoL9y: $this->assign("\162\157\x77", $row); goto pyDeQ; pyDeQ: return $this->fetch(); goto zTwYl; g16tg: P3MzK: goto VoL9y; uIxMR: if (!empty($row)) { goto P3MzK; } goto CihHb; njv5j: $row = Contact::I()->getContact($id); goto uIxMR; zTwYl: } public function password($id) { goto fcXPl; u0loP: $data = input("\160\x6f\x73\x74\56\144\x61\164\141\x2f\141"); goto rK8oI; PqUjc: $this->assign(["\x63\157\x6e\x74\x61\143\164" => $contact]); goto sKH2R; fcXPl: if (!$this->request->isGet()) { goto volVr; } goto KQxDt; sKH2R: return $this->fetch(); goto W2aXQ; W2aXQ: volVr: goto u0loP; rK8oI: try { Contact::I()->password($id, $data["\160\x61\x73\163\167\157\x72\144"], $data["\x75\x73\145\162\156\141\x6d\145"]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto SH7Xd; SH7Xd: return ajaxSuccess("\350\xae\xbe\347\xbd\256\346\210\220\345\212\x9f"); goto y0xse; KQxDt: $contact = Contact::I()->getContact($id); goto PqUjc; y0xse: } }
