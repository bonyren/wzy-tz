<?php
 namespace app\index\controller; use app\index\logic\Enterprise; use think\Controller; use think\Log; use think\Debug; use think\Request; use think\Db; use app\index\logic\Defs; use app\index\logic\Scientists as ScientistsLogic; use app\index\logic\ProgressLogs as ProgressLogsLogic; class Scientists extends Common { public function index($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = '', $order = '') { goto nXd2v; ABDiy: $data = ScientistsLogic::I()->load($search, $page, $rows, $sort, $order); goto nQjy9; Zrf2i: FsrAC: goto lxrTP; S6bIx: MiFK0: goto Zrf2i; x9AjC: return $this->fetch(); goto DGQmY; ztfF2: foreach ($data["\x72\157\167\x73"] as $k => $v) { $data["\162\157\x77\x73"][$k]["\x61\x73\x73\151\x67\x6e\145\162"] = $users[$v["\x61\x73\x73\151\147\156\145\x72"]]["\x72\x65\x61\x6c\156\141\155\x65"]; p2b3u: } goto S6bIx; nQjy9: if (empty($data["\162\x6f\167\163"])) { goto FsrAC; } goto GPV7h; DGQmY: JQosP: goto ABDiy; GPV7h: $users = \app\index\logic\Admins::I()->getAllUsers(); goto ztfF2; nXd2v: if (!request()->isGet()) { goto JQosP; } goto x9AjC; lxrTP: return json($data); goto hJOiY; hJOiY: } public function save($id = 0) { goto OJqg9; sU13e: if (!$this->request->isGet()) { goto cSgOz; } goto nkhcu; BVOzS: $this->assign("\x69\x64", $id); goto olKVE; UKjDZ: $infos = input("\x70\157\163\164\x2e\x69\x6e\146\157\x73\57\141"); goto c6t79; olKVE: $this->assign("\165\162\154\110\162\145\x66\163", ["\x70\x72\157\x6a\145\143\x74\x73" => url("\x69\x6e\144\x65\170\57\123\x63\151\145\x6e\164\x69\x73\164\163\57\x70\x72\x6f\152\145\143\164\163", ["\x73\143\151\145\x6e\164\x69\x73\x74\x5f\x69\144" => $id]), "\x72\x65\x71\165\151\x72\x65\155\x65\156\164\163" => url("\x69\x6e\x64\145\x78\x2f\123\x63\151\145\156\x74\x69\163\164\x73\57\162\145\x71\x75\x69\x72\x65\155\145\x6e\164\x73", ["\163\x63\151\x65\x6e\x74\151\x73\164\111\x64" => $id]), "\x65\x76\145\x6e\164\x73" => url("\151\156\144\145\170\x2f\x50\x72\157\147\x72\145\x73\163\114\x6f\x67\x73\57\154\x69\x67\150\164", ["\143\x61\x74\x65\147\x6f\162\x79" => ProgressLogsLogic::PROGRESS_LOG_SCIENTIST_CATEGORY, "\x65\x78\x74\x65\162\156\141\154\111\144" => $id])]); goto y4xMX; grOOk: if ($infos) { goto CvNzl; } goto hbml2; D6z0h: CvNzl: goto va9jq; OJqg9: $logic = ScientistsLogic::I(); goto sU13e; nkhcu: if ($id) { goto C898T; } goto LAt1R; UMzbX: goto CQFej; goto Z9oWv; va9jq: CQFej: goto zd6oV; zd6oV: $this->assign("\x69\156\x66\157\163", $infos); goto BVOzS; y4xMX: return $this->fetch(); goto zdUsZ; bir75: $infos = $logic->get($id); goto grOOk; Z9oWv: C898T: goto bir75; c6t79: try { $logic->save($id, $infos); return ajaxSuccess("\346\210\220\345\x8a\x9f"); } catch (\Exception $e) { return ajaxError("\345\244\261\350\264\xa5\x2c\x20\x6d\x65\163\x73\141\147\145\x3a\40" . $e->getMessage()); } goto e6dgF; hbml2: return $this->fetch("\x63\x6f\155\x6d\x6f\x6e\x2f\145\162\162\157\x72"); goto D6z0h; LAt1R: $infos = $logic->getDefault(); goto UMzbX; zdUsZ: cSgOz: goto UKjDZ; e6dgF: } public function delete($id = 0) { $logic = ScientistsLogic::I(); try { $logic->delete($id); return ajaxSuccess("\346\x88\220\xe5\x8a\x9f"); } catch (\Exception $e) { return ajaxError("\xe5\244\xb1\xe8\264\245\x2c\40\x6d\x65\163\x73\141\147\x65\x3a\x20" . $e->getMessage()); } } public function view($id) { goto SJM4q; UPLR8: return $this->fetch("\x63\157\155\155\x6f\156\57\x65\x72\x72\x6f\x72"); goto KrbgP; SJM4q: $logic = ScientistsLogic::I(); goto qISZX; b_J4E: return $this->fetch(); goto CqaPw; KrbgP: KSAhZ: goto jU0hT; VIZCm: if ($infos) { goto KSAhZ; } goto UPLR8; OfxaA: $this->assign("\165\162\154\110\x72\145\x66\x73", ["\x70\162\x6f\x6a\145\143\164\x73" => url("\151\x6e\x64\x65\170\57\123\x63\x69\x65\156\x74\151\163\164\163\57\160\x72\157\x6a\145\x63\164\x73", ["\x73\x63\151\145\x6e\x74\x69\x73\x74\x5f\151\x64" => $id, "\162\x65\x61\x64\117\x6e\154\171" => 1]), "\162\145\161\x75\x69\x72\145\155\x65\x6e\x74\163" => url("\151\x6e\x64\x65\x78\x2f\123\143\x69\145\x6e\164\151\x73\x74\x73\x2f\162\x65\x71\165\151\162\x65\155\x65\156\x74\x73", ["\163\143\151\x65\x6e\164\151\x73\x74\111\144" => $id, "\162\x65\x61\x64\x4f\x6e\x6c\171" => 1]), "\145\166\145\156\x74\163" => url("\x69\156\144\145\170\x2f\120\162\157\x67\162\145\x73\x73\114\x6f\147\x73\57\154\151\147\x68\x74", ["\x63\x61\x74\x65\147\x6f\162\171" => ProgressLogsLogic::PROGRESS_LOG_SCIENTIST_CATEGORY, "\x65\x78\x74\x65\x72\x6e\141\154\x49\144" => $id, "\162\x65\141\x64\x4f\x6e\154\171" => 1])]); goto b_J4E; jU0hT: $this->assign("\x69\156\x66\x6f\163", $infos); goto OfxaA; qISZX: $infos = $logic->get($id); goto VIZCm; CqaPw: } public function requirements($scientistId, $readOnly = 0) { goto K5pWs; DShEi: $this->assign("\x75\162\154\x48\x72\x65\x66\x73", ["\x69\156\x64\x65\x78" => url("\151\156\144\145\170\57\x53\143\x69\145\x6e\164\151\163\x74\163\x2f\162\145\161\x75\151\162\x65\x6d\145\156\x74\163", ["\x73\143\151\x65\156\x74\x69\163\164\111\144" => $scientistId]), "\163\x61\x76\145" => url("\151\156\144\x65\x78\x2f\123\143\x69\145\156\164\151\x73\x74\x73\57\x72\145\x71\x75\151\x72\x65\155\145\x6e\x74\123\x61\166\145", ["\x73\x63\x69\145\x6e\x74\151\163\164\111\x64" => $scientistId])]); goto QGj3D; bcQzt: if (!empty($scientistId)) { goto G7vqb; } goto MpduF; K5pWs: if (!request()->isGet()) { goto bTF_1; } goto DShEi; t4rcy: G7vqb: goto tTUxL; Xllv8: bTF_1: goto bcQzt; tTUxL: $rows = Db::table("\163\x63\151\145\x6e\164\x69\163\164\137\x72\x65\x71\x75\x69\x72\x65\x6d\145\156\164\163")->where("\163\x63\151\145\x6e\x74\151\163\x74\137\151\144", $scientistId)->field(true)->select(); goto cJRLf; cJRLf: return json($rows); goto rse6Q; MpduF: return json([]); goto t4rcy; YqEmx: return $this->fetch(); goto Xllv8; QGj3D: $this->assign("\162\145\141\x64\x4f\x6e\x6c\x79", $readOnly); goto YqEmx; rse6Q: } public function requirementSave($scientistId, $id = 0) { goto Brobc; Brobc: $infos = input("\160\157\163\x74\56\151\156\146\157\x73\x2f\141"); goto llr7m; wjd5o: Bk2lF: goto nloWY; KY67R: Db::table("\x73\x63\151\x65\156\164\x69\163\x74\137\x72\x65\161\x75\x69\162\x65\155\x65\156\164\163")->where("\x69\144", $id)->update(["\143\x6f\x6e\x74\145\x6e\x74" => $infos["\143\157\156\x74\145\156\x74"]]); goto wjd5o; nloWY: return ajaxSuccess("\xe6\210\x90\345\212\x9f"); goto HsJLy; OvL5O: Db::table("\x73\x63\151\145\156\164\151\x73\164\x5f\x72\x65\161\165\x69\x72\x65\155\x65\x6e\164\x73")->insert(["\163\143\x69\145\156\x74\151\x73\164\x5f\151\144" => $scientistId, "\143\x6f\156\164\145\x6e\164" => $infos["\x63\157\156\164\x65\156\164"]]); goto hHEnZ; BLNlz: Ryvno: goto KY67R; llr7m: if ($id) { goto Ryvno; } goto OvL5O; hHEnZ: goto Bk2lF; goto BLNlz; HsJLy: } public function requirementDelete($id) { Db::table("\163\143\151\145\156\164\x69\x73\164\137\x72\145\161\x75\x69\162\x65\x6d\x65\156\x74\x73")->where("\151\x64", $id)->delete(); return ajaxSuccess("\xe6\x88\220\345\212\x9f"); } public function projects($scientist_id, $readOnly = 0, $page = 1, $rows = DEFAULT_PAGE_ROWS) { goto uvw9n; aqrR6: return $this->fetch(); goto zb2cv; l0HF3: $this->assign("\x73\x63\x69\x65\156\164\x69\163\x74\x5f\151\x64", $scientist_id); goto Aqdrn; XulgN: return json($data); goto dkwnj; Aqdrn: $this->assign("\x72\x65\141\x64\117\156\x6c\x79", $readOnly); goto aqrR6; NczF4: $sou["\x73\143\151\145\x6e\164\x69\x73\x74\x5f\151\x64"] = $scientist_id; goto LOCi9; zb2cv: dvgPR: goto NczF4; uvw9n: if (!$this->request->isGet()) { goto dvgPR; } goto l0HF3; LOCi9: $data = Enterprise::I()->load($sou, $page, $rows); goto XulgN; dkwnj: } public function projectsAdd($scientist_id, $enterprise_id) { Db::table("\x65\156\164\145\162\160\x72\151\x73\x65\x73")->where("\151\x64", "\151\156", $enterprise_id)->setField("\163\143\x69\145\x6e\x74\151\x73\164\x5f\x69\144", $scientist_id); return ajaxSuccess("\346\223\215\344\275\x9c\xe6\210\220\345\212\x9f"); } }
