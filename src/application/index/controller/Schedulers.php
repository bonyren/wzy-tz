<?php
 namespace app\index\controller; use app\cli\model\JobQueue as JobQueueModel; use app\cli\model\Scheduler as SchedulerModel; use app\cli\logic\Scheduler as SchedulerLogic; use think\Log; use think\Debug; class Schedulers extends Common { public function index($page = 1, $rows = DEFAULT_PAGE_ROWS) { goto HSbqX; TJ0mK: if (!empty($total)) { goto f4J5s; } goto CMy7Q; G0Dsf: $items = SchedulerModel::where($where)->page($page, $rows)->order("\x69\x64\x20\144\145\x73\x63")->select(); goto Kdygq; Tc94z: return $this->fetch(); goto nr7PC; HSbqX: if (!$this->request->isGet()) { goto MeVd2; } goto Tc94z; dfvSH: f4J5s: goto G0Dsf; CMy7Q: return json([]); goto dfvSH; bXJty: $where = ["\x64\x65\154\x65\x74\145\x64" => 0]; goto IPYFQ; Kdygq: return json(["\164\157\x74\141\154" => $total, "\x72\x6f\x77\x73" => $items]); goto ZCm3A; IPYFQ: $total = SchedulerModel::where($where)->count(); goto TJ0mK; nr7PC: MeVd2: goto bXJty; ZCm3A: } public function edit($id = '') { goto X9cEQ; zowiQ: if ($id) { goto mzlI6; } goto fc3J1; X9cEQ: if (!$this->request->isGet()) { goto IElL1; } goto zowiQ; zDAiW: if ($row) { goto MvTVK; } goto AqPNo; QOHdZ: IElL1: goto OosuV; f4do_: qI9Bq: goto kZXBE; kZXBE: return $this->fetch('', ["\162\157\167" => $row]); goto QOHdZ; RUxhp: return ajaxSuccess("\344\277\x9d\345\255\x98\346\x88\x90\345\212\x9f"); goto oWlWu; v7W2R: mzlI6: goto NHk3v; tLBjt: SchedulerLogic::I()->saveScheduler($data); goto RUxhp; u1WmE: MvTVK: goto f4do_; OFaE_: goto qI9Bq; goto v7W2R; fc3J1: $row = ["\151\x64" => 0, "\x6e\x61\x6d\145" => '', "\144\151\x73\141\x62\154\145\144" => 0, "\x6a\x6f\142" => '', "\151\x6e\x74\x65\162\x76\141\x6c" => '', "\x64\141\164\145\137\x74\151\155\x65\137\x73\x74\141\x72\x74" => date("\x59\55\155\55\x64\40\x48\72\x69"), "\x64\141\164\x65\x5f\164\151\155\x65\x5f\145\156\x64" => '']; goto OFaE_; AqPNo: return $this->fetch("\143\157\x6d\x6d\157\156\x2f\x65\162\x72\157\x72"); goto u1WmE; NHk3v: $row = SchedulerLogic::I()->getScheduler($id); goto zDAiW; OosuV: $data = input("\x70\x6f\163\164\56"); goto UwpTQ; UwpTQ: $data["\151\x64"] = intval($id); goto tLBjt; oWlWu: } public function remove($id) { try { SchedulerModel::update(["\x64\145\x6c\145\164\x65\144" => 1], ["\x69\x64" => $id]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\345\210\240\xe9\231\xa4\346\210\x90\345\212\237"); } public function view($id) { $row = SchedulerLogic::I()->getScheduler($id); return $this->fetch('', ["\162\x6f\167" => $row]); } public function logs($page = 1, $rows = DEFAULT_PAGE_ROWS, $scheduler_id = 0) { goto Db4wV; JoCGo: return $this->fetch('', ["\x73\143\150\145\x64\165\x6c\145\162\x5f\x69\144" => $scheduler_id]); goto ZvZxa; ouBwx: $total = JobQueueModel::where($where)->count(); goto q3T5A; HaxX1: $items = JobQueueModel::where($where)->page($page, $rows)->order("\x69\144\40\104\105\123\x43")->select(); goto FOiWX; jX0KY: return json([]); goto dcQ5W; dcQ5W: HQW11: goto HaxX1; JoIJJ: $where = ["\163\x63\150\x65\x64\165\x6c\145\162\x5f\x69\x64" => $scheduler_id]; goto ouBwx; Db4wV: if (!$this->request->isGet()) { goto Q3Sds; } goto JoCGo; FOiWX: return json(["\164\x6f\164\x61\154" => $total, "\162\x6f\167\x73" => $items]); goto Jwp39; ZvZxa: Q3Sds: goto JoIJJ; q3T5A: if (!empty($total)) { goto HQW11; } goto jX0KY; Jwp39: } }
