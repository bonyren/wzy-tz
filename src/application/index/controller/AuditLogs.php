<?php
 namespace app\index\controller; use app\index\service\View; use think\Db; use think\Log; class AuditLogs extends Common { public function index($models = '', $recordId = '', $field = '', $search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = "\151\x64", $order = "\144\145\x73\x63") { goto FHdjh; VZU7k: $conditions["\155\157\144\145\x6c"] = ["\151\156", explode("\x5f", $models)]; goto KCO9F; aCbcV: if (!$recordId) { goto TQHDg; } goto kRfx6; pxxWZ: if ($sort == "\x69\x64") { goto v7aV0; } goto NN41R; KCO9F: g05Vz: goto aCbcV; FHdjh: if (!request()->isGet()) { goto PCTIE; } goto n3iNx; SQzXp: PCTIE: goto I44fV; clvi5: return json(["\164\157\164\141\x6c" => $totalCount, "\x72\157\x77\163" => $records]); goto SAXEY; u61Nb: if (!$models) { goto g05Vz; } goto VZU7k; n3iNx: $urlHrefs = ["\151\156\x64\145\170" => url("\x69\156\x64\x65\x78\x2f\x41\x75\144\151\x74\114\157\x67\163\57\151\156\x64\145\x78", ["\x6d\x6f\144\145\154\163" => $models, "\162\x65\143\157\x72\144\x49\144" => $recordId, "\146\x69\145\154\x64" => $field])]; goto PGGLR; NN41R: $order = "\x69\144\x20\144\x65\x73\x63"; goto gOEKK; PGGLR: $this->assign("\165\162\x6c\110\x72\x65\x66\x73", $urlHrefs); goto NDvx2; kRfx6: $conditions["\162\x65\x63\x6f\x72\x64\137\x69\x64"] = $recordId; goto xoZSd; JvVNF: $conditions["\146\x69\145\154\x64\x73"] = ["\154\151\153\145", "\45\x7c" . $field . "\174\45"]; goto R8_NU; Dp3VO: $conditions = []; goto u61Nb; I44fV: $limit = ($page - 1) * $rows . "\54" . $rows; goto pxxWZ; gOEKK: goto ry9kG; goto VRvth; NDvx2: return $this->fetch(); goto SQzXp; Yh2Oq: $order = "\151\144\x20" . $order; goto xiZQ8; xiZQ8: ry9kG: goto Dp3VO; bNJ6v: $totalCount = Db::table("\x61\x75\x64\x69\164\x5f\x6c\x6f\x67\x73")->where($conditions)->count(); goto bc23i; xoZSd: TQHDg: goto waM_1; bc23i: $records = Db::table("\141\165\x64\x69\x74\x5f\154\x6f\x67\x73")->alias("\114")->join("\x41\x64\155\x69\x6e\163\40\101", "\114\56\x63\150\141\x6e\x67\x65\x64\x5f\142\x79\x3d\x41\x2e\x61\144\155\x69\x6e\137\151\x64", "\x4c\x45\106\x54")->where($conditions)->limit($limit)->order($order)->field("\114\56\52\54\40\101\56\162\x65\x61\x6c\x6e\x61\x6d\x65")->select(); goto clvi5; VRvth: v7aV0: goto Yh2Oq; R8_NU: jTBPf: goto bNJ6v; waM_1: if (!$field) { goto jTBPf; } goto JvVNF; SAXEY: } public function view($model, $record_id, $field = '') { goto p_6JO; IQsEr: if (!$field) { goto a_qQO; } goto AhDlD; dA8mU: a_qQO: goto daW4n; daW4n: $rows = db("\x61\x75\144\x69\x74\x5f\x6c\157\x67\x73")->alias("\x6c")->join("\141\x64\155\x69\x6e\163\40\141", "\x61\x2e\141\144\x6d\x69\x6e\137\x69\x64\x3d\x6c\56\143\x68\141\x6e\x67\x65\144\x5f\142\171")->field("\x6c\56\x2a\x2c\141\x2e\x72\145\x61\154\x6e\141\x6d\x65")->where($where)->order("\154\56\x69\x64\40\144\145\x73\143")->select(); goto YmFWJ; YmFWJ: if (!empty($rows)) { goto gNlat; } goto SnuhK; p_6JO: View::auditLogs("\164\x65\163\x74", "\62\x30", "\52"); goto xAD6R; AhDlD: $where["\154\56\x66\151\x65\x6c\144\163"] = ["\x6c\x69\x6b\x65", "\x25\174" . $field . "\x7c\45"]; goto dA8mU; WfUFE: return $this->fetch('', ["\x72\157\x77\163" => $rows]); goto Fk0wX; xAD6R: $where = ["\x6c\56\155\157\x64\x65\x6c" => $model, "\x6c\x2e\x72\x65\x63\157\162\x64\x5f\151\x64" => $record_id]; goto IQsEr; SnuhK: $rows = []; goto aPLGy; aPLGy: gNlat: goto WfUFE; Fk0wX: } }
