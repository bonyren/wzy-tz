<?php
 namespace app\index\controller; use app\index\logic\Tag; class Tags extends Common { public function setTags($category, $default_value = '') { goto b5Y_j; a0dMw: $pools = Tag::I()->getTagsByCategory($category); goto Ef69U; WW4DY: CH3U0: goto oFT3C; Ef69U: $default_value = $default_value ? explode("\54", $default_value) : []; goto mugSf; b5Y_j: if (!$this->request->isGet()) { goto CH3U0; } goto a0dMw; mugSf: $this->assign(["\160\x6f\157\154\x73" => $pools, "\x63\141\164\145\147\157\x72\171" => intval($category), "\x64\145\x66\x61\165\154\164\137\166\141\x6c\165\145" => json_encode($default_value), "\165\x72\x6c\x73" => ["\141\144\144" => url("\151\x6e\144\x65\x78\x2f\164\141\x67\163\x2f\x61\x64\x64")]]); goto r87bu; r87bu: return $this->fetch(); goto WW4DY; oFT3C: } public function add($name, $category) { try { $id = Tag::I()->addTag($name, $category); return ajaxSuccess('', ["\x69\x64" => $id, "\x6e\x61\x6d\x65" => htmlspecialchars($name)]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } } public function showTagsBatch($category, $record_id) { goto uBWe5; fWun5: QKUjx: goto GOubC; GOubC: $data = []; goto lxGab; lxGab: foreach ($rows as $record_id => $tags) { $data[$record_id] = $this->fetch("\x70\154\x75\x67\x69\156\x2f\164\141\x67\x67\145\162\x5f\x76\x69\145\167", ["\x74\141\147\163" => $tags]); CP15z: } goto M_IBq; Rbml7: return json($data); goto fpoPt; pGGaq: return json([]); goto fWun5; uBWe5: $rows = Tag::I()->getTagsBatch($category, $record_id); goto h1oDl; h1oDl: if (!empty($rows)) { goto QKUjx; } goto pGGaq; M_IBq: iG26V: goto Rbml7; fpoPt: } }
