<?php
 namespace app\index\controller; use app\index\logic\Contact; use app\index\logic\Defs; use app\index\logic\Enterprise; use app\index\logic\Extra; use app\index\logic\Meeting; use app\index\logic\SubIndustryLogic; use app\index\logic\Upload; use app\index\logic\UsersFollow; use app\index\model\Attachments; use app\index\model\Dropdowns; use app\index\model\Edividends; use app\index\model\EFounders; use app\index\model\FundsEnterprises; use app\index\model\FundsFinanceIncomes; use think\Db; use think\Log; use app\index\service\Credit as CreditService; class Enterprises extends Common { protected $_model_name = "\145\x6e\164\145\x72\160\x72\151\163\145\x73"; protected $step2tab = array(1 => 0, 2 => 1, 3 => 1, 4 => 2, 5 => 3, 6 => 4); public function _initialize() { parent::_initialize(); $this->assign("\137\155\157\x64\x65\x6c\x5f\156\141\155\145", $this->_model_name); } public function getIndustriesTree() { $industries = Enterprise::I()->treeIndustries(); return json(array_values($industries)); } public function creditSearch($search = array()) { goto yk_Ok; EUlhh: if (!emptyInArray($search, "\x6b\167")) { goto OSatK; } goto EeAnh; maHl4: V3Ww0: goto EUlhh; UO9cY: try { $records = CreditService::I()->search($kw); } catch (\Exception $e) { Log::error($e->getMessage()); return ajaxDatagridDataError($e->getMessage()); } goto K6Z9U; yk_Ok: if (!$this->request->isGet()) { goto V3Ww0; } goto mXvlV; c4Zgr: OSatK: goto NUmhq; NUmhq: $kw = $search["\153\167"]; goto UO9cY; EeAnh: return json([]); goto c4Zgr; mXvlV: return $this->fetch(); goto maHl4; K6Z9U: return json($records); goto uiLFJ; uiLFJ: } public function external($source) { goto h6Xu3; DOuKw: return $this->{$source}($kw); goto TKc5y; klV27: $this->assign("\x73\x65\141\x72\143\150\137\165\162\154", url("\145\156\164\145\162\160\x72\151\163\145\163\57\145\170\164\x65\162\x6e\x61\x6c", ["\x73\x6f\165\x72\143\x65" => $source])); goto DOuKw; h6Xu3: $kw = input("\162\145\x71\165\145\x73\164\x2e\x6b\167"); goto klV27; TKc5y: } public function qcc($kw = '') { goto oizSl; MMOfV: $this->assign(["\163\145\141\x72\143\x68" => true, "\153\167" => $kw]); goto tL1Dy; InN1s: try { goto ENQK1; hGpOk: preg_match_all($regex, $html, $matches); goto rHn03; Ilo0J: Log::write("\x71\x63\143\x20\162\145\x74\x75\x72\x6e\40\143\x6f\156\164\145\156\x74\x3a\40" . $html, Log::NOTICE); goto AQ26z; aYWXt: $html = $response->getBody()->getContents(); goto Ilo0J; AQ26z: $regex = "\x7c\x3c\164\141\142\x6c\145\x20\x63\154\x61\163\163\75\x22\x6e\x74\x61\x62\x6c\145\x20\156\x74\x61\142\x6c\x65\x2d\154\x69\163\x74\42\40\144\x61\x74\x61\55\x76\55\x2e\52\x3e\x2e\52\74\57\x74\x61\x62\154\145\x3e\174\125\151\163"; goto hGpOk; ENQK1: $http = new \GuzzleHttp\Client(); goto e73Mu; rHn03: $this->assign("\143\157\155\160\141\156\151\x65\163", $matches[0][0]); goto g2Tkh; e73Mu: $response = $http->get("\x68\x74\164\160\163\x3a\x2f\x2f\167\x77\167\56\x71\151\143\150\x61\143\150\x61\x2e\x63\157\155\x2f\x73\x65\x61\x72\143\150", ["\x71\x75\x65\x72\171" => ["\x6b\x65\171" => $kw], "\x63\x75\x72\154" => [CURLOPT_SSL_VERIFYPEER => false, CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1], "\150\145\x61\x64\x65\x72\163" => ["\x55\x73\145\x72\55\x41\147\x65\x6e\x74" => "\115\x6f\x7a\x69\x6c\154\141\x2f\65\56\x30\x20\50\127\x69\156\144\x6f\167\x73\x20\x4e\x54\40\61\60\56\x30\73\40\127\x69\156\x36\x34\x3b\x20\x78\x36\64\51\x20\101\x70\160\x6c\145\x57\145\142\x4b\x69\x74\57\65\63\x37\56\63\x36\x20\x28\113\x48\x54\x4d\x4c\x2c\x20\x6c\151\x6b\x65\40\x47\x65\x63\153\157\51\40\103\150\162\157\x6d\145\57\67\66\56\60\x2e\x33\70\x30\71\56\61\x33\x32\40\123\141\x66\141\162\151\x2f\x35\x33\x37\x2e\x33\x36", "\x43\x6f\157\x6b\151\145" => "\x55\x4d\x5f\x64\x69\x73\164\x69\x6e\143\164\x69\x64\x3d\61\66\143\61\x65\62\x30\146\141\65\62\61\x37\x32\x2d\60\x65\x63\x64\60\x34\x31\x62\x33\x33\x64\65\67\x33\x2d\71\x33\x33\x33\60\66\x31\x2d\61\146\141\x34\x30\60\55\x31\66\143\61\x65\62\60\146\141\65\x33\62\x61\x34\73\x20\172\x67\x5f\x64\151\x64\75\x25\67\102\45\x32\x32\x64\x69\x64\45\62\x32\x25\63\101\x25\62\60\45\62\62\61\x36\x63\x31\145\x32\x31\62\x34\70\x39\x34\70\55\60\60\71\64\x38\61\144\64\141\x37\61\x39\71\x32\55\71\63\x33\x33\60\x36\x31\55\61\146\x61\x34\60\60\55\x31\66\x63\x31\x65\62\x31\62\x34\70\141\64\x34\144\45\62\x32\x25\x37\104\x3b\40\137\x75\141\x62\x5f\x63\x6f\154\154\x69\156\141\75\61\65\x36\x33\70\67\63\65\x38\x35\62\x32\x31\65\x36\67\x34\x35\x33\65\x30\63\x33\61\x3b\x20\x51\103\x43\123\105\x53\x53\x49\104\75\x71\x6d\x61\x31\146\141\x6a\66\165\153\156\x31\142\x72\x31\165\67\164\154\64\60\x38\143\x62\152\63\73\40\x48\155\x5f\154\x76\x74\x5f\63\x34\65\66\142\145\x65\x34\x36\x38\143\x38\63\143\x63\66\x33\146\x62\x35\x31\64\67\x66\61\61\71\x66\61\x30\67\x35\x3d\61\x35\x37\x33\x34\63\70\64\x32\x33\x3b\x20\x61\143\x77\x5f\164\143\x3d\x37\x39\60\x39\x66\x34\x31\67\61\x35\x37\x33\x34\x33\70\64\62\62\62\70\x31\67\x31\x37\x39\x65\67\65\x62\64\145\x33\65\x31\144\142\144\142\63\x30\145\x32\66\61\x35\70\64\x38\x39\x38\x61\65\63\x35\145\66\x35\x65\x3b\x20\x43\116\x5a\x5a\x44\101\124\101\x31\62\65\64\70\64\62\62\62\x38\75\x33\x38\x35\x33\x35\x38\64\66\x37\x2d\x31\65\66\63\x38\x36\71\x37\x34\64\x2d\x68\164\x74\x70\163\45\x32\65\63\x41\x25\62\x35\62\106\45\x32\x35\x32\106\x77\167\167\56\x62\x61\151\144\x75\x2e\x63\157\155\x25\62\65\x32\x46\x25\x37\x43\61\65\67\x33\67\x31\x39\70\65\x37\x3b\40\x68\x61\x73\123\x68\x6f\x77\x3d\x31\73\x20\x7a\147\137\144\x65\61\144\x31\141\63\65\x62\146\x61\62\64\143\145\x32\71\142\x62\x66\x32\143\67\145\142\61\x37\145\x36\x63\64\146\75\45\67\102\x25\x32\62\x73\x69\144\x25\62\62\45\63\x41\45\x32\60\x31\65\x37\x33\x37\x32\64\70\x39\64\65\x31\66\45\x32\x43\x25\62\62\165\x70\144\141\x74\x65\x64\45\x32\x32\x25\63\x41\45\x32\x30\x31\x35\x37\x33\x37\x32\64\x39\x36\x31\x39\x35\x33\x25\62\x43\45\62\x32\151\156\146\x6f\45\x32\x32\45\x33\x41\x25\62\x30\x31\65\67\x33\x34\x33\x38\x34\x32\62\x39\67\x39\x25\x32\103\x25\x32\x32\x73\165\160\x65\x72\x50\162\x6f\x70\x65\162\164\171\x25\x32\62\x25\63\x41\x25\62\x30\45\x32\62\45\67\102\45\x37\x44\x25\62\x32\45\x32\103\45\x32\x32\160\154\x61\164\x66\x6f\162\x6d\45\x32\62\45\63\101\x25\x32\x30\x25\x32\x32\x25\67\102\45\x37\104\x25\x32\x32\x25\62\x43\45\62\62\x75\164\x6d\45\62\62\45\63\101\x25\62\60\x25\x32\62\x25\67\102\x25\x37\x44\45\x32\x32\x25\x32\103\x25\x32\x32\162\x65\x66\x65\x72\162\x65\x72\x44\x6f\x6d\x61\151\x6e\45\x32\x32\45\x33\101\45\62\60\x25\62\x32\x25\x32\x32\45\62\103\x25\62\62\143\165\x69\x64\45\62\x32\x25\63\101\45\62\60\x25\62\x32\x36\x62\65\142\144\x32\64\64\144\x38\62\x34\x34\x62\x65\62\67\66\61\144\141\144\x63\x36\67\60\x35\143\141\143\63\63\45\x32\x32\45\62\x43\x25\62\x32\172\x73\x25\62\62\x25\63\101\45\62\60\60\45\x32\103\x25\x32\x32\x73\143\x25\x32\62\x25\63\x41\45\62\x30\60\45\x37\x44\x3b\x20\x48\155\x5f\x6c\160\x76\164\137\63\64\65\66\x62\145\x65\64\x36\x38\143\x38\63\143\x63\66\63\x66\142\65\x31\64\x37\146\61\x31\71\x66\x31\60\67\65\x3d\x31\65\67\63\67\62\x34\71\66\x32", "\110\x6f\163\164" => "\167\x77\x77\56\161\x69\143\x68\141\x63\x68\141\56\x63\157\155", "\122\x65\x66\145\x72\x65\x72" => "\x68\164\164\x70\x73\x3a\x2f\57\167\x77\167\x2e\x71\151\143\x68\141\x63\150\x61\56\143\157\155\57"]]); goto aYWXt; g2Tkh: } catch (\Exception $e) { $this->assign("\x65\x72\x72\157\x72", $e->getMessage()); } goto MMOfV; tL1Dy: LUtHz: goto yX0ib; oizSl: if (!($this->request->isPost() && !empty($kw))) { goto LUtHz; } goto InN1s; yX0ib: return $this->fetch(__FUNCTION__); goto xjnB1; xjnB1: } public function index($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $step = 0, $step_state = '') { goto rr5u1; Lfrj_: PQ9Wj: goto QtiiZ; Kp9S3: ni237: goto ERho9; MB79o: goto YfEPs; goto jL3pP; rr5u1: $step = intval($step); goto iNc15; MhsPU: if (empty($founders)) { goto PQ9Wj; } goto gikHq; KWnTm: $search["\163\x74\145\x70\137\163\164\x61\x74\x65"] = $step_state; goto BhGgc; jOVM4: foreach ($data["\x72\x6f\x77\163"] as $k => $v) { goto rPj3V; YsHMs: $uids = explode("\54", $v["\141\x73\x73\x69\x67\x6e\x65\162"] . "\54" . $v["\141\144\144\x69\x74\151\x6f\156\x61\x6c\137\x61\x73\x73\x69\x67\156\x65\162\163"]); goto XBLIf; TMo9L: $founders[$v["\x66\157\x75\x6e\144\145\x72"]] = $v["\146\157\x75\x6e\144\145\162"]; goto Azj8l; XBLIf: $data["\x72\157\167\x73"][$k]["\145\x64\151\x74\141\x62\154\x65"] = $this->loginSuperUser || in_array($this->loginUserId, $uids); goto PkfSF; rPj3V: $assigners .= (empty($assigners) ? '' : "\54") . $v["\x61\x73\163\151\x67\x6e\x65\162"]; goto Q2cwh; UvcpA: sQgKe: goto lJgzN; Azj8l: DXz3n: goto YsHMs; PkfSF: $data["\162\x6f\x77\163"][$k]["\151\x73\137\x66\x6f\x6c\154\157\167"] = isset($follows[$v["\x69\144"]]) ? 1 : 0; goto UvcpA; Q2cwh: if (!$v["\146\x6f\165\x6e\144\145\x72"]) { goto DXz3n; } goto TMo9L; lJgzN: } goto R0obc; UE7yp: if (!$step_state) { goto vPHIL; } goto KWnTm; bBmbM: $this->assign("\x75\162\154\163", $urls); goto WPIVT; QtiiZ: $data["\x66\157\165\x6e\144\145\162\163"] = []; goto XOTkk; Q02UP: if (empty($assigners)) { goto E2UC1; } goto kQ31S; neGKQ: $data["\x61\x73\163\151\x67\x6e\145\162\x73"] = []; goto ORYyV; IPIUw: $search["\x73\164\x65\x70"] = $step; goto w7BQW; DMZ37: goto F_yXn; goto Lfrj_; jL3pP: E2UC1: goto neGKQ; gikHq: $data["\146\157\x75\x6e\x64\x65\x72\x73"] = \app\index\model\Contacts::where("\151\x64", "\x69\x6e", $founders)->column("\151\x64\x2c\156\x61\155\x65\54\x74\x69\164\x6c\x65", "\x69\x64"); goto DMZ37; w7BQW: OyB5H: goto UE7yp; TUKCT: $follows = UsersFollow::I()->getMyFollows(UsersFollow::TYPE_PROJECT, $this->loginUserId); goto jOVM4; kQ31S: $data["\x61\x73\x73\x69\147\156\x65\162\x73"] = \app\index\logic\Admins::I()->getAdminsByIds($assigners); goto MB79o; OZy25: $founders = []; goto TUKCT; XOTkk: F_yXn: goto Q02UP; iNc15: if (!$this->request->isGet()) { goto lSAkt; } goto mfMGL; R0obc: nOaGx: goto MhsPU; ivcsF: return "\x5b\x5d"; goto Kp9S3; suEXc: if (!empty($data)) { goto ni237; } goto ivcsF; BhGgc: vPHIL: goto JfLbR; mfMGL: $urls = ["\145\x64\151\164" => url("\x69\x6e\x64\x65\170\57\x45\x6e\164\145\162\x70\x72\x69\163\x65\x73\x2f\x65\144\x69\x74"), "\144\x65\x6c\145\x74\x65" => url("\151\156\x64\x65\170\x2f\105\156\164\145\162\x70\x72\x69\x73\x65\163\57\x64\145\154\x65\x74\145"), "\166\x69\145\167" => url("\151\156\144\x65\x78\x2f\105\156\x74\x65\162\160\x72\151\163\145\x73\x2f\x76\151\145\x77"), "\147\x6f\x73\x74\x65\160" => url("\151\156\144\x65\170\57\105\x6e\164\145\x72\160\162\x69\163\145\163\x2f\x67\x6f\163\x74\x65\160"), "\x69\x6e\x69\164\x69\141\164\x65\x5f\155\145\145\x74\x69\x6e\147" => url("\151\156\x64\145\170\57\105\156\164\145\162\160\162\151\163\x65\163\x2f\151\156\x69\x74\x69\141\x74\x65\x4d\145\145\x74\x69\156\147")]; goto bBmbM; WPIVT: $this->assign("\163\164\145\x70", $step); goto vY1P5; ERho9: $assigners = ''; goto OZy25; ORYyV: YfEPs: goto QShVR; JfLbR: $data = Enterprise::I()->load($search, $page, $rows); goto suEXc; siHv8: if (!$step) { goto OyB5H; } goto IPIUw; ywlCS: lSAkt: goto siHv8; vY1P5: return $this->fetch(); goto ywlCS; QShVR: return json($data); goto Edl4m; Edl4m: } public function edit($id = 0) { goto IRaqx; xYOiR: if (!$this->request->isGet()) { goto dWYn6; } goto spN68; hognS: kaYR5: goto SNQJh; mQ41H: VY7Zd: goto hognS; ojKmf: if (!$data["\x65\170\x74\x72\141"]) { goto kaYR5; } goto fhjrl; trzae: return $this->fetch(empty($id) ? "\x61\144\144" : "\145\144\151\164"); goto tt0Zi; IRaqx: $enterprise = $id ? Enterprise::I()->getEnterprise($id) : ["\163\164\145\160" => 1]; goto xYOiR; SNQJh: return ajaxSuccess("\xe4\xbf\x9d\xe5\xad\x98\xe6\x88\x90\xe5\212\237"); goto ilwRx; uNieX: SubIndustryLogic::I()->replaceEnterpriseSubIndustry($id, $enterprise["\145\x78\x74\x72\141"]["\x73\x75\x62\x5f\x69\156\x64\165\163\x74\x72\x79"], $data["\x65\x78\164\162\141"]["\x73\165\x62\137\x69\156\144\165\x73\x74\x72\171"]); goto mQ41H; tt0Zi: dWYn6: goto D4_bg; OOkwT: try { goto yDT3g; JIO6j: Enterprise::I()->setEnterpriseFounders($id, $founder_id); goto OS2SC; C5oHp: if (!isset($founder_id)) { goto YgGvA; } goto JIO6j; D3I8L: jCQW9: goto fr6L7; NHiHM: $founder_id = Contact::I()->saveContact(0, $founder); goto vnJLv; tUnn3: goto OVn9H; goto G8WT5; G8WT5: d3sk_: goto GmBdz; cLcjY: Contact::I()->saveContact($enterprise["\146\157\x75\156\144\x65\x72"], $founder); goto tUnn3; mmfF2: OVn9H: goto D3I8L; c9ULt: $founder["\141\163\163\x69\x67\156\145\162"] = $data["\145\x6e\164\145\162\x70\x72\151\x73\145"]["\141\163\163\x69\147\156\x65\162"]; goto yUVO4; yDT3g: $founder = $data["\146\157\x75\x6e\x64\145\x72"]; goto HE25s; OS2SC: YgGvA: goto WS81l; HE25s: if (!$founder) { goto jCQW9; } goto c9ULt; vnJLv: $data["\145\156\164\x65\x72\160\162\151\163\x65"]["\146\x6f\165\x6e\144\145\162"] = $founder_id; goto mmfF2; yUVO4: $founder["\x61\144\x64\151\164\x69\x6f\x6e\141\154\x5f\141\x73\163\151\147\x6e\145\x72\163"] = $data["\145\156\164\x65\162\160\162\151\163\x65"]["\141\144\144\x69\164\x69\157\x6e\141\154\137\x61\x73\163\151\147\156\x65\x72\163"]; goto L9xY8; GmBdz: $founder["\x74\151\x74\154\x65"] = "\xe5\210\233\345\247\213\xe4\272\272"; goto NHiHM; fr6L7: $id = Enterprise::I()->saveEnterprise($id, $data["\145\156\164\145\x72\x70\162\x69\163\145"]); goto C5oHp; L9xY8: if (empty($id)) { goto d3sk_; } goto cLcjY; WS81l: } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto rVO26; fhjrl: Extra::I()->setValue("\x45\156\x74\145\162\160\x72\x69\163\x65\x73", $id, $data["\145\x78\164\162\141"]); goto o9Ok7; bX6et: tjdjE: goto ojKmf; o9Ok7: if (!$data["\x65\x78\x74\162\141"]["\x73\x75\x62\x5f\x69\156\144\x75\163\164\162\171"]) { goto VY7Zd; } goto uNieX; pxWuo: Upload::I()->relateAttaches($data["\160\x65\x6e\x64\x69\156\x67\137\146\151\x6c\145\x73"], $id); goto bX6et; D4_bg: $data = input("\x70\157\163\x74\56"); goto OOkwT; rVO26: if (empty($data["\160\x65\x6e\144\x69\x6e\147\x5f\x66\151\154\145\163"])) { goto tjdjE; } goto pxWuo; spN68: $this->assign(["\x72\145\x61\144\157\156\x6c\171" => 0, "\145\x6e\x74\145\162\x70\162\151\163\145" => $enterprise, "\145\x78\x74\145\162\x6e\141\x6c" => array_merge(["\x6e\x61\155\145" => '', "\142\157\163\x73" => '', "\x61\x64\x64\x72\x65\x73\163" => '', "\x70\150\x6f\156\x65" => ''], input("\x67\145\x74\56")), "\165\x73\145\x72\x73" => \app\index\logic\Admins::I()->getAllUsers(), "\144\x65\x66\x61\165\154\x74\137\164\141\142" => $this->step2tab[$enterprise["\163\x74\145\x70"]]]); goto trzae; ilwRx: } public function baseInfo($enterprise_id, $readonly = 1) { goto sHWhs; D_vhV: if (!empty($enterprise)) { goto Q5I12; } goto qA3OH; SSh82: return $this->fetch($readonly ? "\x62\141\163\145\x5f\x69\156\x66\157\137\x76\151\x65\167" : "\x62\141\163\x65\x5f\151\156\146\157"); goto ap3tE; sHWhs: $enterprise = Enterprise::I()->getEnterprise($enterprise_id); goto D_vhV; Jk8G0: Q5I12: goto Kg8ji; qA3OH: return $this->fetch("\x63\x6f\155\155\x6f\156\x2f\x6d\151\x73\163\x69\156\147"); goto Jk8G0; cWlrH: $this->assign(["\165\163\145\x72\x73" => \app\index\logic\Admins::I()->getAllUsers(), "\x65\156\164\x65\162\160\x72\x69\x73\145" => $enterprise, "\162\145\x61\x64\x6f\156\x6c\x79" => intval($readonly)]); goto SSh82; Kg8ji: $enterprise["\x66\157\165\x6e\144\145\162"] = Contact::I()->getContact($enterprise["\146\157\x75\x6e\144\x65\x72"]); goto cWlrH; ap3tE: } public function companyInfo($enterprise_id, $readonly = 1) { goto cF0Yh; ij6TY: $this->assign("\145\156\164\145\162\160\x72\x69\x73\145", $enterprise); goto fkppd; dL2QE: $this->assign("\150\151\144\x64\x65\156", $readonly ? "\150\151\144\x64\x65\x6e" : ''); goto HeC8x; fkppd: $this->assign("\x72\145\x61\144\x6f\156\x6c\171", intval($readonly)); goto dL2QE; HeC8x: return $this->fetch(); goto A_Kwo; cF0Yh: $enterprise = Enterprise::I()->getEnterprise($enterprise_id); goto ij6TY; A_Kwo: } public function view($id) { goto kSKNz; k21sj: return $this->fetch(); goto HryBo; kSKNz: $enterprise = Enterprise::I()->getEnterprise($id); goto Fv_sc; bJIEz: $this->assign("\x66\x6f\165\156\144\145\x72", $founder ?: []); goto S5cgg; q6ltt: $this->assign("\162\x6f\167", $enterprise); goto bJIEz; Fv_sc: if (!empty($enterprise)) { goto Cr9MG; } goto UEj65; wQQMg: $founder = Contact::I()->getContact($enterprise["\x66\157\x75\156\144\x65\x72"]); goto q6ltt; S5cgg: $this->assign("\144\145\x66\141\165\154\x74\x5f\x74\141\x62", $this->step2tab[$enterprise["\163\164\x65\x70"]]); goto k21sj; UEj65: return $this->fetch("\x63\x6f\x6d\155\x6f\156\x2f\155\x69\163\x73\151\x6e\147"); goto cXxUt; cXxUt: Cr9MG: goto wQQMg; HryBo: } public function gostep($id, $type) { try { Enterprise::I()->goStep($id, $type); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\346\223\215\344\xbd\234\346\210\220\345\212\237"); } public function delete($id) { try { Enterprise::I()->delete($id); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\345\x88\xa0\xe9\x99\244\346\x88\220\345\x8a\237"); } public function initiateMeeting($meeting_type, $enterprise_id, $meeting_id = 0) { goto JICp6; E16AB: q6pRQ: goto EQlDG; ggyJU: ThbF4: goto Xa1mw; U7VbF: $enterprise = Enterprise::I()->getEnterprise($enterprise_id); goto QvE6s; gKoMH: if (empty($meeting_id)) { goto q6pRQ; } goto IoixC; IoixC: $data = input("\160\x6f\163\164\56\x64\141\x74\141\57\x61"); goto Mmjqx; OJ7B6: if (empty($_POST["\x70\x65\156\x64\x69\x6e\x67\137\x66\151\154\x65\163"])) { goto MBAFt; } goto yYdNC; wgECz: MBAFt: goto TIp5W; MI5KV: return $this->fetch(); goto cOl7b; ZCEZt: $meeting_title .= "\xef\xbc\210" . date("\131\155\x64") . "\357\xbc\211"; goto k3uYl; o3g8g: if ($get["\x69\156\166\145\x73\x74\x6d\x65\156\x74\137\x69\x64"]) { goto zS4eY; } goto ZCEZt; Dmnz2: $data["\x65\156\164\x65\x72\160\x72\151\x73\145\x5f\151\x64"] = $enterprise_id; goto kwi9M; o1jFY: try { $meeting_id = Meeting::I()->updateProjectMeeting($meeting_id, $data); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto LdJ1Y; wAgIF: $meeting_title = ($enterprise["\141\154\x69\x61\x73"] ?: $enterprise["\x6e\x61\x6d\145"]) . "\55" . $type_info["\x6c\141\x62\145\x6c"]; goto o3g8g; ItPEF: $type_info = Meeting::getTypes($meeting_type); goto wAgIF; SMAzD: if (empty($meeting)) { goto N3C4d; } goto jf2gr; JICp6: $get = input("\147\x65\x74\56"); goto B0F0H; TIp5W: suolL: goto We7JM; EQlDG: $data = input("\160\157\x73\x74\x2e\x64\141\x74\141\57\141"); goto vUFEl; Mmjqx: $data["\x74\x79\160\145"] = $meeting_type; goto uJ1U1; k3uYl: goto ZyeRV; goto ak06C; uJ1U1: $data["\145\x6e\164\145\x72\160\x72\x69\163\x65\x5f\151\x64"] = $enterprise_id; goto UWFKw; Xa1mw: $this->assign("\142\x69\x6e\144", ["\145\x6e\x74\145\162\x70\x72\x69\163\145" => $enterprise, "\x6d\x65\x65\x74\151\156\147" => $meeting, "\145\x6e\164\145\162\x70\162\x69\x73\x65\137\x69\x64" => $enterprise_id, "\155\x65\x65\164\x69\x6e\147\x5f\164\171\x70\145" => $meeting_type, "\x74\151\x74\154\145" => $meeting_title]); goto xjx1o; Rvvpa: G8jp2: goto SMAzD; OmVo6: BhJ1q: goto U7VbF; A_a_s: $stage = Db::table("\151\156\x76\145\163\164\x6d\145\156\x74")->where(["\151\x64" => $get["\x69\x6e\x76\x65\x73\164\x6d\145\x6e\164\137\151\x64"]])->value("\x66\151\156\x61\x6e\x63\151\x6e\147\137\163\x74\141\x67\x65"); goto krlGC; xjx1o: $this->assign("\x70\x72\x69\x6e\x63\x69\x70\x6c\x65", $enterprise["\x65\170\164\162\141"]["\160\162\151\156\143\151\160\x6c\x65"]); goto MI5KV; ak06C: zS4eY: goto A_a_s; uXig4: goto G8jp2; goto JUqn3; We7JM: return ajaxSuccess("\xe4\xbf\x9d\345\255\230\346\x88\220\xe5\x8a\237"); goto OmVo6; MrsQd: try { $meeting_id = Meeting::I()->setProjectMeeting($data); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto OJ7B6; nlD3c: N3C4d: goto ItPEF; SnEYX: $meeting = Meeting::I()->getRelatedMeeting($meeting_type, $enterprise_id); goto Rvvpa; Jw9_x: $meeting = []; goto uXig4; jf2gr: $meeting_title = $meeting["\x74\151\x74\x6c\x65"]; goto iVFZJ; kwi9M: $data["\x69\156\166\145\x73\x74\155\145\x6e\164\x5f\x69\x64"] = intval($get["\151\x6e\x76\x65\x73\x74\x6d\145\156\x74\137\x69\x64"]); goto MrsQd; vUFEl: $data["\x74\171\x70\145"] = $meeting_type; goto Dmnz2; iVFZJ: goto ThbF4; goto nlD3c; LdJ1Y: goto suolL; goto E16AB; yYdNC: Upload::I()->relateAttaches($_POST["\160\145\156\x64\x69\x6e\147\x5f\146\151\154\145\x73"], $enterprise_id, $meeting_id); goto wgECz; krlGC: $stage = Dropdowns::getLabel("\146\151\156\141\156\x63\151\x6e\147\x5f\163\x74\141\x67\145", $stage); goto eqcku; UWFKw: $data["\x69\x6e\x76\x65\163\164\155\x65\x6e\x74\137\x69\x64"] = intval($get["\x69\x6e\166\x65\163\x74\155\145\156\164\137\x69\144"]); goto o1jFY; JUqn3: J2bm7: goto SnEYX; B0F0H: if (!$this->request->isPost()) { goto BhJ1q; } goto gKoMH; eqcku: $meeting_title .= "\xef\274\x88{$stage}\xef\xbc\x89"; goto hy6W4; hy6W4: ZyeRV: goto ggyJU; QvE6s: if (empty($get["\151\x6e\166\145\163\164\x6d\x65\156\164\137\151\x64"]) && $enterprise["\163\164\x65\160\x5f\x73\x74\141\x74\145"] > 0) { goto J2bm7; } goto Jw9_x; cOl7b: } public function completeMeeting($meeting_id) { goto kB0Lv; JG50b: if (!$meeting["\151\156\166\145\163\x74\155\x65\x6e\x74\137\151\x64"]) { goto Y3MDa; } goto vtdoT; DbXjN: $status = 1; goto jAmAy; HWhsA: V_ree: goto MXkB7; X2Xin: $update = []; goto nrIJB; fYxom: goto PQXjc; goto HWhsA; nrIJB: if ($meeting["\163\164\x61\x74\165\163"] == Meeting::STATUS_ENDED_REJECT) { goto V_ree; } goto dZTC2; MXkB7: $update["\x73\x74\x65\x70\137\x73\x74\141\x74\145"] = "\x2d\x31"; goto XSGmi; B9xpU: B2vaZ: goto MJWRE; HMo40: xdYST: goto wstGK; F6a02: T2fgw: goto fYxom; wstGK: Db::table("\151\x6e\x76\145\x73\x74\155\145\x6e\164")->where(["\x69\x64" => $meeting["\151\x6e\x76\x65\x73\164\x6d\x65\x6e\164\137\x69\x64"]])->setField("\x73\x74\x61\164\x75\163", $status); goto ited1; Zefl4: $enterprise = Enterprise::I()->getEnterprise($meeting["\162\x65\x6c\141\164\145\x5f\x69\x64"]); goto X2Xin; dZTC2: switch ($meeting["\x74\171\x70\145"]) { case Enterprise::STEP_LEARN: goto Mx2iU; G6Wey: $update["\163\x74\145\160\137\163\164\x61\x74\145"] = 0; goto Jz7mg; dFJ6x: $update["\x73\164\145\160"] = Enterprise::STEP_DD; goto G6Wey; Jz7mg: C_HCv: goto Lhddb; Mx2iU: if (!($enterprise["\x73\164\x65\160"] == Enterprise::STEP_LEARN)) { goto C_HCv; } goto dFJ6x; Lhddb: goto T2fgw; goto fOrWL; fOrWL: case Enterprise::STEP_DD: goto pRsM7; Xo8FH: uIk3m: goto G1Xf_; pRsM7: if (!($enterprise["\x73\x74\x65\160"] == Enterprise::STEP_DD)) { goto uIk3m; } goto VhTpm; G1Xf_: goto T2fgw; goto gLC1I; VhTpm: $update["\163\x74\145\x70"] = Enterprise::STEP_INVESTING; goto hIFYp; hIFYp: $update["\x73\x74\x65\x70\137\x73\164\141\164\145"] = 0; goto Xo8FH; gLC1I: } goto ozm8D; ozm8D: AhYU_: goto F6a02; MJWRE: $status = -1; goto HMo40; kB0Lv: $meeting = Meeting::I()->getMeeting($meeting_id); goto JG50b; XSGmi: $update["\151\x73\x74\x6f\x70"] = "\x2d\61"; goto EhIX2; ited1: return; goto AOBfm; AOBfm: Y3MDa: goto Zefl4; EhIX2: PQXjc: goto tW_sq; jAmAy: goto xdYST; goto B9xpU; vtdoT: if ($meeting["\x73\x74\x61\x74\x75\163"] == Meeting::STATUS_ENDED_REJECT) { goto B2vaZ; } goto DbXjN; tW_sq: model("\x45\156\x74\x65\162\x70\162\151\x73\x65\x73")->save($update, ["\151\x64" => $meeting["\162\145\x6c\141\x74\145\137\151\144"]]); goto NuOzA; NuOzA: } public function investFundsSet($enterprise_id, $investment_id, $funds_id) { goto mKjcw; Ify1d: mCEjx: goto Mf9G6; Ji6wj: L6bvI: goto zW0nU; NKcEn: $funds = db("\146\x75\156\144\163")->where($where)->field("\x66\x75\156\144\x5f\151\x64\54\x6e\x61\155\x65\54\163\151\172\x65")->order("\x66\165\156\x64\x5f\151\144\40\x61\x73\x63")->select(); goto gXihG; gXihG: if (!empty($funds)) { goto zWOB0; } goto MhCdM; Mf9G6: try { $post = input("\x70\x6f\x73\x74\56"); Enterprise::I()->addInvestFunds($enterprise_id, $investment_id, $post["\146\165\x6e\144\x73"]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto Pb9IF; MhCdM: $funds = []; goto PlWLk; mKjcw: if (!$this->request->isGet()) { goto mCEjx; } goto KsT1t; zW0nU: $where["\146\165\x6e\144\x5f\151\144"] = isset($funds_id[1]) ? ["\x69\x6e", $funds_id] : $funds_id[0]; goto NKcEn; KsT1t: if (is_array($funds_id)) { goto L6bvI; } goto I017D; Pb9IF: return ajaxSuccess("\350\xae\xbe\xe7\xbd\xae\346\x88\x90\345\212\x9f"); goto Pz1u2; vwfVf: return $this->fetch('', ["\145\x6e\x74\145\162\160\x72\151\x73\x65\137\x69\144" => $enterprise_id, "\x65\x6e\164\x65\x72\160\162\151\163\x65" => Enterprise::I()->getEnterprise($enterprise_id), "\146\165\156\144\x73" => $funds]); goto Ify1d; PlWLk: zWOB0: goto vwfVf; I017D: $funds_id = explode("\54", $funds_id); goto Ji6wj; Pz1u2: } public function investFundEdit($id) { goto wia01; XOAPx: return $this->fetch('', ["\144\x61\x74\141" => $data, "\x65\x6c\145\x6d\145\x6e\164\x5f\151\x64" => $element_id, "\165\x75\151\144" => md5("\43{$element_id}")]); goto Vetql; vxD6A: $element_id = "\146\x66\x65\137\x65\144\x69\164\x5f" . $data["\x66\146\x65\x5f\x69\x64"]; goto XOAPx; Kr_Zw: $data["\x66\x75\x6e\x64"] = \app\index\model\Funds::get($data["\146\x75\156\x64\137\151\x64"]); goto vxD6A; VI7es: return ajaxSuccess(); goto Z6laT; ekcXP: $data = $mode::get($id)->toArray(); goto Kr_Zw; cgsWW: if (!$this->request->isGet()) { goto n_Mvo; } goto ekcXP; Vetql: n_Mvo: goto tEnqs; tEnqs: try { $mode::update($_POST["\x64\x61\164\x61"], ["\x69\x64" => $id], true); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto VI7es; wia01: $mode = new FundsEnterprises(); goto cgsWW; Z6laT: } public function investFundRemove($id) { try { FundsEnterprises::destroy($id); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\xe5\210\240\xe9\x99\xa4\xe6\210\x90\xe5\212\x9f"); } public function investmentAndFinancing($enterprise_id, $readonly = null) { return $this->fetch('', ["\145\156\x74\x65\x72\160\162\x69\163\145\137\151\144" => $enterprise_id, "\162\x65\x61\x64\157\x6e\154\171" => $readonly]); } public function financeRecords($enterprise_id, $page = 1, $rows = DEFAULT_PAGE_ROWS, $readonly = 0) { goto EkUqX; omhtO: $items = Db::table("\145\x6e\x74\x65\162\160\x72\151\x73\145\163\x5f\146\151\x6e\x61\x6e\x63\x69\x6e\x67")->where($where)->page($page, $rows)->order("\x77\150\145\x6e\40\144\145\163\x63\54\151\144\x20\x64\x65\x73\x63")->select(); goto ndX9_; ndX9_: return json(["\164\157\164\141\154" => $count, "\x72\x6f\167\x73" => $items]); goto Jh7hx; uWtfS: eMXfW: goto Et2zY; ux0LQ: if (!empty($count)) { goto H7PL4; } goto tUeyP; Et2zY: $where = ["\x65\x6e\164\145\162\x70\162\x69\163\145\137\151\x64" => $enterprise_id]; goto ruDT5; k9mqs: H7PL4: goto omhtO; tUeyP: return json([]); goto k9mqs; ruDT5: $count = Db::table("\x65\156\164\145\x72\160\162\x69\x73\145\163\x5f\146\x69\x6e\141\156\143\151\x6e\x67")->where($where)->count(); goto ux0LQ; EkUqX: if (!$this->request->isGet()) { goto eMXfW; } goto cWCyd; cWCyd: return $this->fetch('', ["\x65\156\164\x65\162\160\162\151\x73\145\137\151\144" => $enterprise_id, "\162\x65\x61\x64\x6f\x6e\x6c\x79" => $readonly]); goto uWtfS; Jh7hx: } public function editFinanceRecord($enterprise_id, $id = 0) { goto qpsmX; SdEuK: DOijm: goto SA3nw; S51Zb: $info = $id ? Enterprise::I()->getFinancingInfo($id) : []; goto m_l2M; K2n1F: return ajaxError("\350\257\xb7\350\xae\xbe\347\275\256\345\x8f\x98\xe6\x9b\xb4\xe6\x98\216\xe7\xbb\206"); goto LCQSN; cYmsZ: Db::table("\145\x6e\x74\145\x72\x70\162\x69\x73\x65\163\137\x66\151\156\141\x6e\143\151\156\147")->where(["\x69\x64" => $id])->setField("\145\x73\x69\x64", $esid); goto K5u9z; vtR3A: LXBrf: goto wt0Nt; VCutF: $es["\144\x61\x74\x65"] = $data["\167\x68\x65\156"]; goto B098K; SA3nw: $data = input("\x70\x6f\163\x74\56\144\x61\164\141\x2f\x61"); goto ePphl; Gp8SD: $data["\145\156\x74\x65\162\160\x72\151\163\x65\137\151\144"] = $enterprise_id; goto py4V1; py4V1: $id = Db::table("\x65\156\x74\x65\162\160\162\x69\x73\x65\163\x5f\146\151\x6e\x61\x6e\143\151\x6e\x67")->insertGetId($data); goto nBGK9; e3f0r: Db::table("\145\x6e\164\x65\x72\160\x72\151\163\145\163\137\x66\151\156\x61\x6e\143\x69\156\x67")->where(["\151\x64" => $id])->update($data); goto vtR3A; kfCy6: if ($id) { goto uamBP; } goto Gp8SD; MYz_u: if (!empty($rows)) { goto SSILo; } goto K2n1F; BueQs: $es["\x65\x69\144"] = $enterprise_id; goto VCutF; Ee1Of: model("\x45\x6e\x74\x65\x72\160\162\x69\163\x65\x73")->save(["\x6c\x61\x74\x65\x73\x74\x5f\x76\x61\x6c\165\x61\x74\151\x6f\156" => $latest_valuation], ["\151\x64" => $enterprise_id]); goto S1qJN; ePphl: $rows = $_POST["\162\x6f\x77\x73" . $data["\x74\171\160\145"]]; goto MYz_u; zqctV: CAz4P: goto rd1_4; B098K: $es["\156\141\155\145"] = $data["\164\x69\x74\154\x65"] . "\40\55\40\350\202\xa1\xe4\270\x9c\350\241\xa8"; goto AYgcy; nBGK9: if (empty($_POST["\160\145\x6e\x64\x69\x6e\x67\x5f\x66\x69\x6c\145\x73"])) { goto CAz4P; } goto Y9rrD; K5u9z: lw75i: goto tX7HK; rd1_4: goto LXBrf; goto Jjou9; GAQ8b: if (!$_POST["\163\150\141\162\x65\150\157\154\x64\x65\162\163\x5f\x65\170\x63\145\154"]) { goto lw75i; } goto BueQs; tX7HK: return ajaxSuccess("\xe4\277\x9d\345\255\230\xe6\x88\220\345\x8a\x9f"); goto NM1AF; qpsmX: if (!$this->request->isGet()) { goto DOijm; } goto S51Zb; AYgcy: $esid = Enterprise::I()->addShareholders($es, $_POST["\x73\x68\x61\x72\145\x68\157\x6c\144\145\162\x73\x5f\145\x78\143\145\154"]); goto cYmsZ; wt0Nt: $latest_valuation = Db::table("\145\x6e\x74\x65\x72\x70\162\151\163\x65\163\137\x66\x69\156\x61\156\x63\x69\156\147")->where(["\145\156\164\145\x72\160\x72\x69\x73\145\137\x69\x64" => $enterprise_id])->order("\167\150\145\x6e", "\x64\145\x73\x63")->value("\166\x61\154\x75\x61\164\151\x6f\156"); goto Ee1Of; S1qJN: Extra::I()->setValue("\145\156\164\145\162\x70\162\151\163\x65\x73\137\x66\x69\156\141\156\143\151\x6e\147", $id, "\x64\x65\164\141\151\154", array_values($rows)); goto GAQ8b; Jjou9: uamBP: goto e3f0r; m_l2M: return $this->fetch('', ["\151\156\146\157" => $info]); goto SdEuK; Y9rrD: Upload::I()->relateAttaches($_POST["\x70\x65\x6e\144\x69\x6e\147\137\x66\151\x6c\145\x73"], $id); goto zqctV; LCQSN: SSILo: goto kfCy6; NM1AF: } public function delFinanceRecord($id) { goto pkBax; gxLI4: Extra::I()->removeKey("\x65\156\164\145\162\x70\162\151\x73\x65\x73\137\146\151\x6e\141\156\x63\151\x6e\x67", $id, "\144\145\x74\x61\x69\154"); goto ZNeCu; pkBax: Db::table("\x65\x6e\164\x65\162\160\162\x69\x73\x65\163\137\x66\151\156\x61\156\143\x69\x6e\x67")->where(["\151\x64" => $id])->delete(); goto gxLI4; ZNeCu: return ajaxSuccess("\345\x88\240\xe9\x99\xa4\xe6\x88\220\345\x8a\237"); goto KZiwB; KZiwB: } public function getFinancingDetail($efid) { $data = Enterprise::I()->getFinancingInfo($efid); return $this->fetch('', ["\144\141\164\x61" => $data]); } public function shareholders($enterprise_id, $page = 1, $rows = DEFAULT_PAGE_ROWS, $readonly = 0) { goto YmrUt; IgRUw: VEN7A: goto Gq2NE; iqnh0: $where = ["\145\x69\x64" => $enterprise_id]; goto phlhX; oWpfy: return $this->fetch('', ["\145\156\x74\x65\x72\x70\162\x69\x73\x65\137\151\x64" => $enterprise_id, "\162\x65\x61\144\x6f\156\x6c\171" => $readonly]); goto Mjn7S; YmrUt: if (!$this->request->isGet()) { goto SumFp; } goto oWpfy; Qy2ZR: return json(["\164\157\x74\141\154" => $count, "\162\157\x77\163" => $items]); goto YdQAd; phlhX: $count = Db::table("\145\156\x74\x65\162\160\x72\151\163\145\x5f\163\x68\x61\x72\145\x68\x6f\154\144\145\162")->where($where)->count(); goto s1suL; Mjn7S: SumFp: goto iqnh0; kJ_NX: return json([]); goto IgRUw; s1suL: if (!empty($count)) { goto VEN7A; } goto kJ_NX; Gq2NE: $items = Db::table("\145\x6e\x74\145\162\160\162\151\x73\x65\x5f\163\x68\x61\x72\x65\150\157\154\144\x65\162")->where($where)->page($page, $rows)->order("\151\144\x20\x64\145\163\x63")->select(); goto Qy2ZR; YdQAd: } public function getShareholderDetail($esid) { $rows = Db::table("\145\x6e\164\145\162\x70\162\151\x73\145\x5f\x73\150\x61\x72\145\x68\157\x6c\x64\145\x72\x5f\144\x65\x74\x61\151\154")->where(["\145\163\x69\x64" => $esid])->order("\151\144\40\x61\x73\x63")->select(); return $this->fetch('', ["\x72\x6f\167\x73" => $rows, "\162\145\x61\x64\157\x6e\154\x79" => !isset($_GET["\x72\x65\141\x64\157\x6e\154\x79"]) || $_GET["\162\x65\x61\x64\157\156\154\x79"]]); } public function shareholdersEdit($enterprise_id = 0, $id = 0, $readonly = 0) { goto FDZ3f; avSBT: return ajaxSuccess("\344\xbf\x9d\xe5\xad\230\xe6\210\x90\345\212\237"); goto eFeMm; drYgo: if (empty($_POST["\x64\145\164\x61\151\x6c"])) { goto CywuF; } goto hkitH; wf8Rl: $data["\151\144"] = $id; goto RTM2v; FDZ3f: if (!$this->request->isGet()) { goto wPLXO; } goto eJqoW; e3xlT: wPLXO: goto ziAer; ziAer: $data = input("\160\157\163\164\x2e\144\x61\x74\x61\57\141"); goto wf8Rl; qSdWS: try { Enterprise::I()->addShareholders($data, $_POST["\x73\x68\x61\x72\x65\x68\157\154\144\145\x72\x73\x5f\145\170\143\145\x6c"]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto drYgo; RTM2v: $data["\x65\151\x64"] = $enterprise_id; goto qSdWS; hkitH: Enterprise::I()->updateShareholderDetail($_POST["\144\x65\164\141\x69\x6c"]); goto cSnU_; eJqoW: $info = Db::table("\145\x6e\x74\x65\x72\160\x72\x69\x73\145\137\163\150\141\162\x65\x68\157\x6c\x64\145\162")->where(["\x69\144" => $id])->find(); goto t8obZ; cSnU_: CywuF: goto avSBT; t8obZ: return $this->fetch('', ["\151\156\146\x6f" => $info, "\x72\145\x61\x64\157\156\x6c\x79" => $readonly]); goto e3xlT; eFeMm: } public function shareholdersRemove($id) { Enterprise::I()->delShareholders($id); return ajaxSuccess("\xe5\x88\240\xe9\x99\244\xe6\210\220\345\212\x9f"); } public function dividends($enterprise_id, $search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $readonly = 0) { goto zUXKG; XuRAz: jzXe2: goto x9VkU; zUXKG: if (!$this->request->isGet()) { goto jzXe2; } goto ndP1r; zpzWW: $items = Db::table("\145\x6e\x74\145\x72\160\162\x69\163\145\163\x5f\x64\151\166\151\144\x65\x6e\144\163")->alias("\x65\x64")->join("\x66\x75\x6e\144\x73\x20\146", "\146\56\x66\x75\156\144\x5f\151\x64\75\x65\x64\56\x66\165\x6e\x64\137\151\x64")->join("\x66\165\156\x64\x73\x5f\146\x69\156\x61\x6e\143\145\137\151\x6e\143\x6f\155\145\x73\x20\146\146\151", "\146\146\x69\56\x66\146\x69\137\x69\144\x3d\x65\x64\x2e\146\146\x69\137\151\x64")->field("\x65\144\56\151\x64\x2c\145\x64\x2e\x66\165\156\x64\x5f\151\x64\54\x65\144\56\146\x66\x69\137\x69\x64\x2c\x65\x64\x2e\144\x65\163\x63\x72\151\160\x74\151\157\x6e\x2c\146\x2e\x6e\141\155\145\x20\x61\163\40\x66\165\x6e\x64\x5f\x6e\141\x6d\145\x2c\x66\146\151\x2e\x61\155\157\165\x6e\x74\x2c\146\x66\x69\56\144\x61\x74\145")->where($where)->page($page, $rows)->order("\145\144\x2e\151\144\x20\104\105\123\103")->select(); goto gGfaD; ZbjhB: $count = Db::table("\x65\156\164\x65\x72\x70\x72\x69\163\x65\x73\x5f\144\151\x76\x69\x64\x65\156\144\x73")->alias("\145\144")->where($where)->count(); goto zpzWW; gGfaD: return json(["\x74\x6f\x74\141\154" => $count, "\162\157\x77\163" => $items]); goto Yg_Mg; x9VkU: $where = ["\145\144\x2e\145\x6e\164\x65\x72\160\x72\151\x73\x65\137\151\x64" => $enterprise_id]; goto ZbjhB; ndP1r: return $this->fetch('', ["\145\x6e\164\145\162\160\162\151\x73\x65\x5f\x69\144" => $enterprise_id, "\162\145\x61\x64\157\x6e\154\171" => $readonly]); goto XuRAz; Yg_Mg: } public function editDividends($enterprise_id, $id = 0) { goto ZoyBL; tSpsJ: return $this->fetch('', ["\145\144" => $ed, "\146\x75\x6e\144\163" => $funds, "\145\156\x74\x65\x72\160\162\x69\x73\145\x5f\151\144" => $enterprise_id, "\145\x6e\x74\145\x72\160\x72\x69\x73\145" => Enterprise::I()->getEnterprise($enterprise_id)]); goto clQsZ; iWfUJ: $funds = Enterprise::I()->getInvestFunds($enterprise_id, $ed["\146\165\x6e\144\x5f\151\x64"]); goto tSpsJ; S5El4: if ($id) { goto GbP2Z; } goto tiVtH; AGwsj: return ajaxSuccess("\xe4\xbf\x9d\xe5\xad\230\346\x88\220\345\212\x9f"); goto ijA7V; sl_6Y: $ed = $model::get($id); goto tIAUw; ZoyBL: $model = new Edividends(); goto kmhXS; yzSfw: iP_2z: goto iWfUJ; tiVtH: $ed = []; goto dOlhJ; sGl4z: GbP2Z: goto sl_6Y; tIAUw: $ed["\146\x66\x69"] = FundsFinanceIncomes::get($ed["\146\146\x69\137\151\144"]); goto yzSfw; clQsZ: c8qtC: goto RjFJ1; kmhXS: if (!$this->request->isGet()) { goto c8qtC; } goto S5El4; RjFJ1: try { Enterprise::I()->setDividend($enterprise_id, $_POST["\x61\154\154\x6f\x63\141\x74\145"]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } goto AGwsj; dOlhJ: goto iP_2z; goto sGl4z; ijA7V: } public function delDividends($id) { Enterprise::I()->deleteDividend($id); return ajaxSuccess("\345\x88\240\351\231\244\346\x88\220\345\x8a\237"); } public function founders($enterprise_id, $readonly = 1) { goto qyozh; KjAcl: return $this->fetch('', ["\145\x6e\164\145\x72\x70\x72\151\163\x65\137\x69\144" => $enterprise_id, "\162\x65\x61\144\157\x6e\x6c\171" => $readonly, "\x74\x61\x67\137\165\x72\x6c" => url("\164\x61\147\163\x2f\x73\150\157\167\124\141\x67\x73\x42\141\x74\x63\150", ["\143\141\164\x65\x67\x6f\x72\x79" => 4])]); goto EGPJM; EGPJM: Ez5iq: goto tbHYb; FzTXF: return json(array_values($data)); goto k2yU5; tbHYb: $data = Enterprise::I()->getEnterpriseFounders($enterprise_id); goto FzTXF; qyozh: if (!$this->request->isGet()) { goto Ez5iq; } goto KjAcl; k2yU5: } public function founderRemove($id) { try { EFounders::destroy($id); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\345\x88\xa0\351\231\xa4\346\210\220\xe5\212\237"); } public function filesTab($enterprise_id, $readonly = 0) { $stage = [0 => ["\x6c\141\x62\x65\x6c" => "\xe5\205\xa8\351\203\xa8\346\226\207\344\xbb\xb6"], 1 => ["\x6c\141\x62\x65\154" => "\xe5\x85\245\345\xba\223"], 2 => ["\154\141\142\145\154" => "\347\xa0\x94\347\xa9\266"], 3 => ["\x6c\141\x62\145\x6c" => "\347\xab\213\351\xa1\271"], 4 => ["\x6c\x61\142\145\154" => "\345\260\275\xe8\xb0\x83"], 5 => ["\x6c\x61\x62\x65\x6c" => "\xe6\212\x95\xe5\x86\263"], 6 => ["\x6c\141\x62\145\154" => "\xe4\xba\244\345\211\262"], 7 => ["\x6c\141\x62\145\154" => "\xe7\xae\xa1\347\x90\x86"], 8 => ["\154\141\142\x65\x6c" => "\351\x80\x80\xe5\x87\xba"]]; return $this->fetch('', ["\x65\x6e\164\145\162\160\x72\x69\x73\x65\137\151\144" => $enterprise_id, "\x73\164\141\x67\145" => $stage, "\162\145\x61\144\157\156\x6c\171" => $readonly]); } public function files($enterprise_id, $stage = 0, $pid = 0, $readonly = 0, $search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS) { goto HPF9D; v_P8L: $where = ["\x65\x78\164\x65\x72\x6e\x61\x6c\x5f\151\x64" => $enterprise_id, "\160\151\144" => $pid, "\x73\164\141\164\165\163" => Defs::ATTACHMENT_OK]; goto HF3nh; SkBCl: Mpq1s: goto I2q7Y; Greut: return $this->fetch('', ["\x65\x6e\164\145\x72\160\162\x69\163\145\x5f\x69\144" => $enterprise_id, "\164\171\160\145\163" => $types, "\x73\164\141\147\145" => intval($stage), "\x72\145\x61\144\157\x6e\x6c\171" => $readonly]); goto Cftwn; Cftwn: vtptX: goto v_P8L; HF3nh: if (isset($search["\164\x79\160\145"]) && $search["\x74\171\160\145"] !== '') { goto c_phR; } goto GOh3T; ZhYSk: $types = array_filter($types, function ($v) use($stage) { return $v["\163\x74\141\x67\x65"] == $stage; }); goto SkBCl; mCQZy: BN6Op: goto RBsKy; RBsKy: $files = Attachments::where($where)->page($page, $rows)->order("\145\156\164\x65\x72\145\x64\x20\x64\x65\x73\x63\54\x61\164\x74\x61\143\150\155\x65\x6e\164\137\151\x64\x20\144\x65\x73\x63")->select(); goto dDaR7; CB5WH: if (!$stage) { goto Mpq1s; } goto ZhYSk; Ctxb1: Eg3TT: goto h8EPk; I2q7Y: if (!request()->isGet()) { goto vtptX; } goto Greut; GOh3T: if (!empty($types)) { goto Eg3TT; } goto OvGt9; h8EPk: $where["\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\164\x5f\x74\x79\x70\145"] = ["\x69\x6e", array_keys($types)]; goto uxYsm; MFe9E: $total = Attachments::where($where)->count(); goto x2DRb; jdJCg: return json([]); goto mCQZy; hhwYW: pL3GN: goto JJKjR; dDaR7: return json(["\164\x6f\x74\141\x6c" => $total, "\162\157\x77\x73" => $files]); goto b049W; uxYsm: goto pL3GN; goto ieI7m; gjg_V: $where["\x6f\162\x69\x67\151\156\x61\154\137\156\x61\x6d\x65"] = ["\154\151\153\x65", "\45{$search["\x6e\141\155\145"]}\45"]; goto g7nZz; HPF9D: $types = [0 => ["\x73\x74\141\147\145" => 0], 3 => ["\x73\x74\141\x67\145" => 1], 10 => ["\163\164\141\x67\x65" => 2], 21 => ["\x73\x74\141\147\x65" => 2], 4 => ["\163\x74\x61\x67\x65" => 4], 5 => ["\x73\x74\x61\x67\x65" => 4], 6 => ["\x73\164\141\147\x65" => 4], 7 => ["\x73\164\x61\x67\145" => 4], 27 => ["\x73\x74\x61\147\145" => 4], 9 => ["\x73\x74\141\x67\145" => 5], 11 => ["\163\x74\141\x67\145" => 5], 12 => ["\x73\164\x61\x67\x65" => 6], 13 => ["\x73\164\x61\147\145" => 6], 14 => ["\x73\164\x61\147\145" => 6], 15 => ["\x73\164\x61\147\145" => 6], 16 => ["\163\164\141\147\145" => 6], 17 => ["\163\x74\x61\x67\145" => 6], 18 => ["\163\x74\x61\147\145" => 6], 20 => ["\x73\164\141\x67\x65" => 6], 22 => ["\163\164\x61\147\x65" => 6], 19 => ["\163\x74\141\147\145" => 7], 23 => ["\x73\x74\141\x67\x65" => 8], 24 => ["\x73\164\141\x67\x65" => 8], 25 => ["\x73\x74\x61\147\x65" => 8], 26 => ["\x73\164\141\x67\x65" => 8], 28 => ["\x73\164\x61\x67\x65" => 5]]; goto CB5WH; OvGt9: return json([]); goto Ctxb1; x2DRb: if (!empty($total)) { goto BN6Op; } goto jdJCg; ieI7m: c_phR: goto Juqia; JJKjR: if (!$search["\x6e\x61\155\x65"]) { goto yjoU9; } goto gjg_V; Juqia: $where["\x61\x74\164\141\x63\x68\155\x65\156\x74\137\164\x79\160\145"] = $search["\164\x79\x70\x65"]; goto hhwYW; g7nZz: yjoU9: goto MFe9E; b049W: } public function exitList($enterprise_id, $page = 1, $rows = DEFAULT_PAGE_ROWS, $readonly = 0) { goto FKdEX; Zowv1: foreach ($items as $k => $v) { goto Thmxk; IFTl6: $items[$k]["\146\x75\156\x64\137\156\x61\155\145"] = $arr["\146\x75\156\x64\137\151\144"] ? Db::table("\146\x75\x6e\144\x73")->where(["\146\x75\156\144\137\x69\x64" => $arr["\x66\x75\156\144\x5f\151\x64"]])->value("\x6e\141\x6d\145") : ''; goto ufb2m; ufb2m: $items[$k]["\162\x6f\165\156\144"] = $arr["\x72\157\x75\156\144"]; goto bJeSt; bJeSt: qeL8d: goto YC2Pa; Thmxk: $arr = empty($v["\152\163\157\156"]) ? [] : json_decode($v["\x6a\163\157\x6e"], true); goto IFTl6; YC2Pa: } goto PnUnT; FKdEX: if (!$this->request->isGet()) { goto YRw05; } goto Xhas3; FyNtt: return "\133\135"; goto jqez6; Pdtnk: return json(["\x74\157\x74\141\154" => $count, "\x72\x6f\x77\163" => $items, "\x74\x79\160\145\163" => Defs::ENTERPRISE_EXIT_TYPES]); goto H_zaU; FyEcu: $count = Db::table("\x65\156\x74\145\x72\x70\x72\x69\x73\145\163\x5f\x64\151\x76\x69\x64\x65\156\144\x73")->where($where)->count(); goto EFxHT; PnUnT: HVP9v: goto Pdtnk; HhmAc: YRw05: goto XUYRA; jqez6: xSKRM: goto AO4HM; EFxHT: if (!empty($count)) { goto xSKRM; } goto FyNtt; XUYRA: $where = ["\x65\x6e\164\145\162\160\162\x69\163\x65\137\151\144" => $enterprise_id]; goto FyEcu; Xhas3: return $this->fetch('', ["\x65\x6e\x74\145\x72\x70\x72\x69\x73\x65\137\151\144" => $enterprise_id, "\162\x65\x61\144\157\x6e\154\x79" => $readonly]); goto HhmAc; AO4HM: $items = Db::table("\145\x6e\164\145\x72\160\162\x69\x73\x65\163\x5f\x64\151\166\151\x64\145\156\x64\x73")->where($where)->page($page, $rows)->order("\x69\x64\40\104\105\x53\103")->select(); goto Zowv1; H_zaU: } public function exitEdit($enterprise_id, $id = 0, $readonly = 0) { goto kp_vu; FHvml: if (!$req["\152\163\157\x6e"]) { goto YquMU; } goto AKt4p; X7eCt: Upload::I()->relateAttaches($req["\x70\145\156\144\x69\156\147\137\146\x69\x6c\145\x73"], $enterprise_id, $id); goto OVksW; WV705: if ($id) { goto AJs0d; } goto E5jtE; ddGEt: $row = Db::table("\145\x6e\x74\145\162\160\162\x69\163\x65\x73\x5f\144\x69\166\x69\144\145\156\144\x73")->where("\151\144", $id)->find(); goto bqhdK; Rs82r: k3A92: goto H92up; ZS6TK: if (empty($id)) { goto k3A92; } goto RRkWp; vXtiO: goto UrlK1; goto WEDXz; kp_vu: if (!$this->request->isGet()) { goto tcBd0; } goto WV705; oF2cy: $id = Db::table("\x65\x6e\x74\x65\162\160\x72\x69\163\x65\163\x5f\144\x69\x76\151\144\x65\156\x64\163")->insertGetId($req["\144\x61\164\141"]); goto KaSUw; LgC2r: return ajaxSuccess("\xe4\277\x9d\345\255\230\346\x88\x90\xe5\212\x9f"); goto ySo2j; U7eCK: frslK: goto LgC2r; HRKTT: return $this->fetch('', ["\x65\x6e\x74\x65\x72\x70\162\x69\163\145\137\x69\144" => $enterprise_id, "\x72\x6f\x77" => $row, "\x6a\163\x6f\x6e" => $json, "\162\x65\141\144\x6f\x6e\154\x79" => $readonly, "\165\162\x6c\x5f\165\x70\x6c\x6f\141\x64" => url("\x69\x6e\144\145\170\x2f\165\160\154\x6f\141\x64\x2f" . ($readonly ? "\166\x69\x65\x77\x41\164\164\x61\x63\x68\145\x73" : "\141\164\x74\141\143\x68\145\x73"), ["\x65\x78\164\145\162\156\x61\154\x49\x64" => $enterprise_id, "\x75\151\x53\164\171\x6c\145" => \app\index\controller\Upload::ATTACHES_UI_TABLE_STYLE]) . "\46\x63\x61\154\x6c\x62\x61\143\x6b\x3d\x45\116\x54\105\122\120\x52\111\123\x45\x5f\x45\x58\x49\124\137\x45\104\x49\x54\56\x75\160\154\157\x61\x64\x65\144"]); goto E4prZ; OVksW: mgx7I: goto U7eCK; D3O4P: YquMU: goto ZS6TK; NS2dN: $req = input("\160\157\x73\164\x2e"); goto FHvml; bqhdK: $json = $row["\152\163\x6f\156"] ? json_decode($row["\x6a\x73\x6f\x6e"], true) : []; goto JtQ97; H92up: $req["\x64\141\164\141"]["\x65\x6e\164\x65\x72\x70\162\151\x73\145\137\x69\x64"] = $enterprise_id; goto oF2cy; AKt4p: $req["\x64\141\164\141"]["\152\163\157\x6e"] = json_encode($req["\x6a\163\x6f\x6e"]); goto D3O4P; E5jtE: $row = $json = []; goto vXtiO; ebww2: goto frslK; goto Rs82r; E4prZ: tcBd0: goto NS2dN; KaSUw: if (!$req["\160\x65\x6e\x64\151\156\147\x5f\146\x69\x6c\x65\163"]) { goto mgx7I; } goto X7eCt; JtQ97: UrlK1: goto HRKTT; RRkWp: Db::table("\x65\x6e\164\x65\162\x70\162\151\163\x65\x73\x5f\x64\151\x76\x69\x64\x65\156\x64\163")->where(["\151\144" => $id])->update($req["\x64\141\x74\x61"]); goto ebww2; WEDXz: AJs0d: goto ddGEt; ySo2j: } public function exitDelete($id) { Enterprise::I()->deleteDividend($id); return ajaxSuccess("\345\x88\xa0\351\x99\244\346\210\220\345\212\x9f"); } public function exitFundAllocation($id) { goto Ki1if; rO5kB: $funds = Enterprise::I()->getInvestFunds($exit["\145\156\x74\x65\162\160\162\x69\163\x65\137\151\x64"]); goto KP52u; KP52u: $e = Enterprise::I()->getEnterprise($exit["\145\156\164\x65\x72\x70\162\151\x73\x65\137\151\144"]); goto oroLT; jAR0a: return ajaxSuccess("\xe4\xbf\x9d\xe5\xad\230\xe6\x88\220\xe5\x8a\237"); goto Ty4PQ; Ki1if: if (!$this->request->isGet()) { goto RDGJ8; } goto om51d; lSqI2: $ffis = FundsFinanceIncomes::where("\145\x78\151\x74\137\151\144", $id)->column("\146\146\x69\137\x69\144", "\146\x75\156\x64\x5f\x69\144"); goto rO5kB; zHmuw: $ffi_id = $_POST["\x66\x66\x69\x5f\151\144"]; goto wST6H; wST6H: if (!$ffi_id) { goto mXr5e; } goto n_dt1; n_dt1: Db::table("\x66\165\156\144\x73\x5f\x66\x69\156\141\156\x63\x65\137\x69\156\x63\x6f\x6d\145\x73")->where("\146\x66\x69\137\x69\x64", "\151\x6e", $ffi_id)->update(["\x65\170\151\164\x5f\x69\144" => $id]); goto aj4ZZ; om51d: $exit = Edividends::get($id); goto lSqI2; aj4ZZ: mXr5e: goto jAR0a; qa9zU: RDGJ8: goto zHmuw; oroLT: return $this->fetch('', ["\x65\144" => $exit, "\x66\165\x6e\x64\x73" => $funds, "\x66\146\x69\x73" => $ffis ? $ffis : [], "\146\146\151\x5f\x74\x69\164\154\145" => $e["\x6e\x61\155\145"] . "\55" . Defs::ENTERPRISE_EXIT_TYPES[$exit["\x74\171\160\x65"]]]); goto qa9zU; Ty4PQ: } }
