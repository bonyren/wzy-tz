<?php
 namespace app\index\logic; use think\Db; use think\Log; use app\index\model\Attachments; use app\common\CommonDefs; class Upload extends Base { const ATTACH_ENTERPRISE_EXIT_PROTOCOL = 23; const ATTACH_ENTERPRISE_EXIT_DELIVERY = 24; const ATTACH_FUND_PARTNER_AGREEMENT = 100; const ATTACH_FUND_COLLECT_PLAN_OTHER = 101; const ATTACH_FUND_COLLECT_BP = 102; const ATTACH_FUND_FILING_LETTER = 110; const ATTACH_FUND_COLLECT_BUSINESS_REG_PROXY_AGREEMENT = 111; const ATTACH_FUND_COLLECT_BUSINESS_REG_OTHER = 112; const ATTACH_FUND_COLLECT_BUSINESS_REG_BUSINESS_LICENSE = 113; const ATTACH_FUND_COLLECT_HOSTING_PLAN_AGREEMENT = 121; const ATTACH_FUND_COLLECT_HOSTING_PLAN_OTHER = 122; const ATTACH_FUND_COLLECT_TAX_OTHER = 131; const ATTACH_FUND_COLLECT_FILING_OTHER = 141; const ATTACH_FUND_COLLECT_DELIVERY = 142; const ATTACH_FUND_CHANGE_LOGS = 145; const ATTACH_FUND_MANAGE_BUSINESS_CHANGE = 150; const ATTACH_FUND_MANAGE_TAX_CHANGE = 151; const ATTACH_FUND_MANAGE_FILING_CHANGE = 152; const ATTACH_FUND_MANAGE_REPORT_CHANGE = 153; const ATTACH_FUND_DISPATCH_PARTNERS = 154; const ATTACH_PARTNER = 200; const ATTACH_PROGRESS_LOGS = 250; const ATTACH_INDUSTRY = 300; const ATTACH_NOTES = 500; const ATTACH_KNOWLEDGE = 800; public static $attachTypeDefs = array(3 => array("\x65\156\x74\x69\164\171\137\164\171\x70\x65" => Defs::ENTITY_PROJECT, "\154\141\x62\x65\154" => "\345\x95\x86\344\xb8\232\xe8\xae\xa1\xe5\210\x92\344\271\246"), 4 => array("\x65\x6e\164\151\x74\171\137\x74\x79\x70\x65" => Defs::ENTITY_PROJECT, "\x6c\x61\142\145\154" => "\xe8\264\xa2\345\212\241"), 5 => array("\145\156\164\x69\x74\x79\137\164\171\160\x65" => Defs::ENTITY_PROJECT, "\154\141\x62\x65\154" => "\346\263\x95\345\212\241"), 6 => array("\x65\x6e\x74\151\x74\171\137\x74\171\160\145" => Defs::ENTITY_PROJECT, "\154\x61\x62\145\x6c" => "\345\xae\242\346\210\267\46\xe4\270\x9a\xe5\212\241"), 7 => array("\x65\x6e\164\x69\x74\x79\x5f\164\171\x70\145" => Defs::ENTITY_PROJECT, "\x6c\141\142\145\154" => "\xe4\xba\xa7\xe5\x93\201\x26\346\x8a\200\346\x9c\xaf"), 8 => array("\x65\x6e\164\151\164\171\x5f\x74\171\x70\145" => Defs::ENTITY_TALENT, "\154\141\x62\145\x6c" => "\345\210\233\xe5\xa7\213\xe4\xba\272\351\231\x84\344\xbb\xb6"), 9 => array("\x65\156\x74\x69\164\x79\x5f\x74\171\160\145" => Defs::ENTITY_PROJECT, "\154\141\142\145\154" => "\xe6\x8a\x95\350\265\x84\xe5\xbb\xba\xe8\256\xae\344\271\246"), 10 => array("\145\156\x74\x69\x74\171\x5f\164\171\x70\145" => Defs::ENTITY_PROJECT, "\154\x61\x62\x65\154" => "\xe7\273\274\345\x90\x88\xe6\235\220\346\226\231"), 11 => array("\x65\x6e\x74\151\164\171\x5f\164\x79\x70\145" => Defs::ENTITY_PROJECT, "\154\141\x62\145\154" => "\346\x8a\225\350\265\x84\xe5\x8d\x8f\xe8\256\xae\xef\xbc\210\xe4\xba\xa4\xe5\211\xb2\xef\274\x89"), 12 => array("\x65\156\x74\151\164\171\137\x74\x79\x70\145" => Defs::ENTITY_PROJECT, "\x6c\x61\x62\145\x6c" => "\xe8\202\xa1\344\xb8\234\xe4\xbc\x9a\345\206\xb3\350\xae\256\55\xe7\x9b\226\xe7\xab\xa0\xe9\231\204\344\273\266"), 13 => array("\x65\x6e\164\151\x74\171\137\x74\171\160\145" => Defs::ENTITY_PROJECT, "\x6c\x61\142\145\154" => "\346\x8a\225\350\265\204\xe5\215\x8f\350\xae\xae\x2d\347\233\226\347\xab\240\xe9\231\204\xe4\xbb\266"), 14 => array("\x65\x6e\x74\151\x74\171\x5f\164\171\x70\x65" => Defs::ENTITY_PROJECT, "\x6c\141\x62\x65\154" => "\346\212\225\345\xa7\x94\344\xbc\x9a\xe5\206\xb3\350\256\xae\x2d\xe7\xad\276\345\255\227\xe9\x99\x84\344\xbb\266"), 15 => array("\x65\x6e\x74\151\164\x79\x5f\164\x79\x70\145" => Defs::ENTITY_PROJECT, "\154\x61\142\145\154" => "\xe5\x90\210\350\247\204\xe8\257\201\xe6\230\x8e\x2d\xe7\x9b\x96\347\xab\240\xe9\231\204\344\273\266"), 16 => array("\145\156\164\151\164\171\x5f\x74\x79\x70\145" => Defs::ENTITY_PROJECT, "\x6c\141\x62\x65\154" => "\350\x82\xa1\344\270\x9c\xe6\x94\276\xe5\274\203\344\274\x98\xe5\205\x88\350\264\xad\xe4\271\xb0\xe6\x9d\203\x2d\347\255\276\xe5\255\227\xe9\x99\204\344\273\xb6"), 17 => array("\145\156\164\x69\164\171\137\164\171\160\145" => Defs::ENTITY_PROJECT, "\x6c\x61\142\x65\154" => "\346\211\x93\346\254\xbe\350\xb4\246\345\x8f\267\351\x80\x9a\xe7\237\245\55\347\233\x96\xe7\xab\240\351\231\204\xe4\xbb\266"), 18 => array("\145\x6e\164\151\x74\x79\137\x74\x79\160\145" => Defs::ENTITY_PROJECT, "\154\141\x62\x65\x6c" => "\xe4\xba\244\xe5\x89\xb2\345\x90\216\350\257\201\346\230\x8e"), 19 => array("\145\x6e\x74\151\164\171\137\164\x79\160\145" => Defs::ENTITY_PROJECT, "\x6c\x61\142\x65\154" => "\xe6\x8a\225\xe5\220\216\xe8\264\xa2\345\212\xa1\xe6\212\245\345\221\x8a"), 20 => array("\145\156\164\x69\164\x79\x5f\x74\x79\x70\x65" => Defs::ENTITY_PROJECT, "\x6c\x61\142\145\154" => "\xe5\210\222\xe6\254\xbe\346\x8c\x87\344\273\244"), 21 => array("\x65\156\x74\x69\164\x79\x5f\x74\x79\x70\x65" => Defs::ENTITY_PROJECT, "\154\141\x62\x65\154" => "\345\210\233\xe5\xa7\213\345\x9b\xa2\351\x98\x9f"), 22 => array("\145\x6e\164\x69\x74\x79\137\164\x79\160\x65" => Defs::ENTITY_PROJECT, "\154\x61\x62\145\154" => "\xe8\220\245\344\270\232\346\211\247\347\x85\xa7"), self::ATTACH_ENTERPRISE_EXIT_PROTOCOL => array("\145\x6e\164\x69\x74\171\137\164\171\160\145" => Defs::ENTITY_PROJECT, "\x6c\x61\142\145\154" => "\xe9\200\x80\xe5\x87\xba\345\215\x8f\350\256\xae\xe5\x8f\x8a\xe6\226\x87\344\273\xb6"), self::ATTACH_ENTERPRISE_EXIT_DELIVERY => array("\x65\x6e\x74\151\x74\x79\x5f\x74\171\x70\145" => Defs::ENTITY_PROJECT, "\154\141\x62\x65\x6c" => "\344\272\xa4\345\x89\xb2\350\257\201\346\x98\216\xe6\x96\x87\xe4\xbb\xb6"), 25 => array("\145\x6e\x74\x69\164\x79\137\164\x79\160\x65" => Defs::ENTITY_PROJECT, "\154\141\142\145\154" => "\xe6\212\225\xe8\xb5\204\350\xbd\xae\346\254\241\55\345\xb0\xbd\xe8\xb0\x83\xe8\xb5\x84\346\226\x99"), 26 => array("\x65\x6e\164\151\x74\x79\x5f\164\171\160\x65" => Defs::ENTITY_PROJECT, "\x6c\141\142\145\154" => "\346\x8a\225\xe8\xb5\x84\xe4\xba\xa4\345\x89\262\55\345\x89\x8d\347\275\xae\346\235\x90\346\x96\231\55\xe5\x85\xb6\344\273\226"), 27 => array("\145\x6e\164\x69\164\171\x5f\x74\171\x70\145" => Defs::ENTITY_PROJECT, "\154\x61\x62\145\x6c" => "\xe8\241\x8c\xe4\xb8\232\xe5\210\x86\346\x9e\220"), 28 => array("\x65\156\x74\x69\164\171\x5f\164\x79\x70\x65" => Defs::ENTITY_PROJECT, "\x6c\141\x62\145\x6c" => "\xe6\x8a\x95\345\206\263\xe4\274\232\350\265\204\xe6\226\231"), 29 => array("\x65\x6e\x74\151\x74\x79\137\164\171\x70\x65" => Defs::ENTITY_COMPANY, "\154\x61\142\145\154" => "\346\213\233\350\x82\xa1\xe8\xaf\xb4\346\x98\216\344\271\xa6"), 30 => array("\x65\x6e\164\x69\x74\x79\x5f\164\171\x70\145" => Defs::ENTITY_COMPANY, "\154\x61\142\145\x6c" => "\xe7\xa0\224\347\251\xb6\xe6\212\xa5\xe5\221\212"), 31 => array("\154\x61\x62\145\154" => "\xe8\202\xa1\xe4\270\x9c\xe8\xa1\xa8\x2d\xe8\x82\241\344\270\234\xe6\x98\x8e\347\273\206"), 32 => array("\154\141\142\x65\x6c" => "\346\x8a\x95\350\xb5\204\345\215\217\350\xae\xae\xef\xbc\x88\xe6\x8a\x95\350\x9e\x8d\xe8\xb5\x84\357\274\x89"), self::ATTACH_NOTES => array("\x6c\141\x62\x65\x6c" => "\351\x80\x9a\347\x94\250\350\xae\xb0\xe5\275\225\xe9\231\204\xe4\273\266\xef\274\210\156\157\164\x65\163\xe8\xa1\xa8\357\xbc\x89"), self::ATTACH_FUND_PARTNER_AGREEMENT => array("\x65\156\x74\151\x74\171\x5f\x74\171\160\145" => Defs::ENTITY_FUND, "\154\x61\142\x65\154" => "\345\x9f\272\351\x87\x91\xe5\220\x88\xe4\274\x99\344\272\xba\345\215\217\350\xae\xae"), self::ATTACH_FUND_COLLECT_BP => array("\x65\x6e\164\151\x74\x79\137\164\171\160\145" => Defs::ENTITY_FUND, "\154\141\x62\145\154" => "\xe5\237\xba\xe9\x87\221\xe5\225\206\344\xb8\232\350\256\xa1\345\210\222\344\xb9\246"), self::ATTACH_FUND_FILING_LETTER => array("\x65\x6e\164\151\164\171\137\x74\x79\160\145" => Defs::ENTITY_FUND, "\x6c\x61\142\145\154" => "\345\x9f\272\xe9\207\221\xe5\xa4\207\xe6\xa1\210"), self::ATTACH_FUND_COLLECT_BUSINESS_REG_PROXY_AGREEMENT => array("\145\156\x74\151\x74\x79\137\x74\171\160\145" => Defs::ENTITY_FUND, "\x6c\x61\x62\x65\x6c" => "\xe5\x9f\xba\xe9\x87\x91\345\x8b\x9f\351\233\206\xe5\xb7\245\345\x95\x86\xe6\xb3\250\xe5\206\214\344\xbb\243\xe7\220\206\xe5\x8d\217\350\xae\256"), self::ATTACH_FUND_COLLECT_BUSINESS_REG_OTHER => array("\145\156\x74\151\x74\x79\137\x74\x79\x70\x65" => Defs::ENTITY_FUND, "\x6c\141\x62\x65\154" => "\345\x9f\272\xe9\207\x91\345\x8b\x9f\xe9\x9b\206\xe5\xb7\245\xe5\x95\x86\xe6\xb3\250\345\x86\214\345\205\xb6\xe4\xbb\x96\351\231\204\xe4\273\xb6"), self::ATTACH_FUND_COLLECT_BUSINESS_REG_BUSINESS_LICENSE => array("\145\156\x74\x69\x74\x79\x5f\164\x79\x70\145" => Defs::ENTITY_FUND, "\154\x61\142\x65\154" => "\xe5\x9f\272\351\207\221\345\267\xa5\xe5\x95\x86\xe6\263\250\xe5\206\x8c\xe8\x90\245\xe4\xb8\x9a\xe6\211\xa7\xe7\x85\xa7"), self::ATTACH_FUND_COLLECT_HOSTING_PLAN_AGREEMENT => array("\145\156\x74\x69\x74\171\137\x74\x79\160\x65" => Defs::ENTITY_FUND, "\154\141\142\145\x6c" => "\xe5\x9f\272\xe9\207\221\xe5\213\237\351\x9b\206\346\x89\230\xe7\256\241\xe5\x8d\x8f\350\256\256"), self::ATTACH_FUND_COLLECT_HOSTING_PLAN_OTHER => array("\145\156\x74\151\x74\x79\137\x74\171\160\145" => Defs::ENTITY_FUND, "\154\x61\x62\x65\x6c" => "\345\x9f\272\351\x87\x91\345\x8b\237\351\233\x86\xe6\x89\x98\xe7\xae\241\345\x85\266\xe4\273\x96\xe9\x99\204\344\273\266"), self::ATTACH_FUND_COLLECT_TAX_OTHER => array("\145\156\x74\x69\164\x79\137\164\x79\160\x65" => Defs::ENTITY_FUND, "\154\x61\x62\145\154" => "\xe5\x9f\xba\xe9\x87\221\347\xa8\x8e\xe5\x8a\xa1\351\231\204\xe4\xbb\xb6"), self::ATTACH_FUND_COLLECT_FILING_OTHER => array("\x65\x6e\x74\x69\164\x79\x5f\x74\x79\x70\145" => Defs::ENTITY_FUND, "\154\141\x62\145\x6c" => "\xe5\x9f\xba\351\x87\221\345\244\x87\346\241\x88\xe5\205\266\344\xbb\x96\xe9\x99\204\344\273\266"), self::ATTACH_FUND_COLLECT_DELIVERY => array("\145\x6e\x74\x69\164\x79\x5f\x74\171\x70\145" => Defs::ENTITY_FUND, "\x6c\x61\x62\145\x6c" => "\xe5\237\272\351\207\221\xe4\272\xa4\345\x89\262\351\x99\204\344\273\xb6"), self::ATTACH_FUND_CHANGE_LOGS => array("\145\156\x74\151\x74\x79\137\164\x79\x70\x65" => Defs::ENTITY_FUND, "\154\141\x62\145\154" => "\xe5\x9f\xba\351\207\221\xe6\227\245\345\xb8\270\xe7\273\264\xe6\x8a\xa4\xe9\x99\x84\344\xbb\266"), self::ATTACH_FUND_MANAGE_BUSINESS_CHANGE => array("\145\x6e\164\151\x74\x79\137\164\x79\160\x65" => Defs::ENTITY_FUND, "\x6c\141\x62\x65\x6c" => "\345\237\272\351\207\221\347\256\241\xe7\x90\x86\xe5\xb7\245\xe5\x95\206\xe5\217\230\xe6\x9b\264\351\231\x84\xe4\273\xb6"), self::ATTACH_FUND_MANAGE_TAX_CHANGE => array("\x65\x6e\164\x69\164\x79\x5f\164\171\160\145" => Defs::ENTITY_FUND, "\154\141\142\x65\x6c" => "\xe5\237\xba\xe9\207\221\xe7\256\241\347\220\206\347\250\x8e\xe5\212\xa1\351\231\204\344\xbb\266"), self::ATTACH_FUND_MANAGE_FILING_CHANGE => array("\x65\x6e\x74\151\164\171\137\x74\x79\160\145" => Defs::ENTITY_FUND, "\154\x61\142\x65\x6c" => "\xe5\237\272\xe9\x87\221\xe5\244\x87\xe6\241\x88\xe7\xbb\xb4\346\212\244\xe9\231\204\344\273\266"), self::ATTACH_FUND_MANAGE_REPORT_CHANGE => array("\145\156\164\151\164\171\137\164\171\x70\x65" => Defs::ENTITY_FUND, "\154\x61\142\145\154" => "\345\237\xba\xe9\207\x91\xe5\xb9\264\xe5\xba\246\xe6\212\xa5\345\x91\212\xe9\231\x84\344\xbb\266"), self::ATTACH_FUND_DISPATCH_PARTNERS => array("\x65\156\164\151\164\171\137\x74\171\x70\145" => Defs::ENTITY_FUND, "\154\141\142\145\154" => "\xe5\237\xba\xe9\207\x91\xe9\xa1\xb9\347\x9b\xae\xe9\x80\x80\xe5\207\272\346\224\xb6\347\x9b\x8a\xe5\210\x86\xe9\205\215\351\x99\x84\xe4\xbb\xb6"), self::ATTACH_PARTNER => array("\145\x6e\x74\x69\x74\x79\137\164\171\x70\x65" => Defs::ENTITY_PARTNER, "\154\x61\x62\x65\154" => "\345\x9f\xba\351\207\221\xe5\220\x88\xe4\274\x99\xe4\xba\xba\351\x99\204\344\xbb\266"), self::ATTACH_INDUSTRY => array("\145\x6e\x74\151\x74\171\x5f\164\x79\160\145" => Defs::ENTITY_INDUSTRY, "\154\x61\142\145\x6c" => "\xe8\241\214\xe7\xa0\x94\346\x8a\245\345\221\212"), self::ATTACH_KNOWLEDGE => array("\x65\x6e\164\151\x74\171\x5f\164\171\160\x65" => Defs::ENTITY_KNOWLEDGE, "\154\x61\x62\x65\154" => "\xe6\231\xba\345\xba\x93\346\226\207\xe7\xab\240")); public static $attachFileTypeDefs = array("\152\x70\x65\147" => array("\x6c\141\142\x65\154" => "\345\x9b\xbe\347\211\x87", "\x69\x63\x6f\x6e" => "\x66\141\x20\x66\x61\x2d\x66\x69\154\x65\55\151\155\x61\147\x65\x2d\157"), "\160\156\147" => array("\x6c\141\x62\x65\x6c" => "\345\x9b\276\xe7\x89\x87", "\151\143\157\156" => "\146\x61\x20\x66\x61\55\146\151\x6c\145\x2d\x69\155\141\147\145\x2d\x6f"), "\152\160\147" => array("\154\141\142\145\x6c" => "\345\233\xbe\xe7\211\x87", "\x69\143\157\156" => "\146\x61\40\x66\x61\x2d\x66\151\154\x65\x2d\x69\x6d\x61\x67\145\x2d\157"), "\x67\151\146" => array("\154\x61\142\x65\154" => "\xe5\x9b\276\xe7\x89\x87", "\x69\143\157\x6e" => "\146\141\x20\x66\x61\55\x66\151\x6c\145\x2d\151\155\x61\x67\x65\x2d\157"), "\144\x6f\x63" => array("\x6c\x61\x62\x65\x6c" => "\127\157\162\x64\346\x96\207\xe6\241\243", "\x69\x63\x6f\156" => "\x66\141\x20\x66\141\55\146\x69\x6c\145\x2d\167\x6f\162\144\55\x6f"), "\x64\157\x63\170" => array("\x6c\141\142\x65\x6c" => "\127\x6f\162\x64\346\x96\x87\346\241\xa3", "\151\143\x6f\156" => "\146\141\40\x66\141\55\x66\151\154\x65\x2d\167\x6f\x72\x64\x2d\x6f"), "\x78\x6c\163" => array("\154\x61\142\145\x6c" => "\x45\170\x63\x65\x6c\350\xa1\250\xe6\240\274", "\151\x63\x6f\x6e" => "\146\141\40\146\141\55\146\x69\154\x65\55\x65\170\x63\x65\x6c\55\x6f"), "\170\x6c\163\x78" => array("\154\x61\x62\145\154" => "\105\x78\143\x65\x6c\350\241\xa8\346\240\274", "\x69\x63\157\x6e" => "\x66\x61\40\x66\x61\55\146\151\154\145\55\x65\170\x63\145\154\x2d\157"), "\160\x70\x74" => array("\154\141\142\145\x6c" => "\xe5\xb9\273\347\201\257\347\x89\207", "\x69\x63\x6f\156" => "\x66\x61\x20\x66\x61\x2d\146\x69\154\145\x2d\160\x6f\x77\x65\x72\x70\x6f\151\x6e\164\x2d\x6f"), "\x70\160\x74\170" => array("\154\x61\x62\145\x6c" => "\xe5\271\xbb\347\x81\xaf\347\x89\x87", "\x69\x63\157\x6e" => "\146\x61\x20\x66\141\x2d\x66\x69\x6c\x65\55\x70\157\x77\x65\x72\x70\157\x69\x6e\x74\55\x6f"), "\x70\x64\x66" => array("\154\x61\142\145\x6c" => "\120\x44\106\346\x96\207\346\xa1\243", "\x69\x63\157\x6e" => "\146\x61\40\x66\x61\55\x66\x69\154\145\x2d\160\x64\146\x2d\157"), "\164\x78\x74" => array("\x6c\x61\x62\x65\154" => "\346\226\x87\xe6\234\254\xe6\x96\207\xe6\xa1\243", "\x69\x63\157\156" => "\146\141\40\x66\141\x2d\x66\x69\154\145\55\x74\x65\x78\x74"), "\x7a\151\160" => array("\x6c\x61\x62\145\154" => "\xe5\x8e\x8b\347\274\251\346\x96\207\346\xa1\xa3", "\151\x63\157\156" => "\146\x61\40\x66\141\x2d\146\151\154\145\x2d\141\162\x63\150\151\166\145\x2d\x6f"), "\162\141\x72" => array("\x6c\x61\x62\145\x6c" => "\xe5\216\x8b\xe7\xbc\251\346\x96\207\xe6\241\243", "\151\143\x6f\x6e" => "\x66\141\40\x66\141\x2d\x66\151\154\x65\55\x61\162\143\x68\151\x76\x65\x2d\157")); protected function __construct() { parent::__construct(); } public function insertAttach($originalName, $saveName, $mimeType, $fileSize, $description, $attachmentType, $externalId, $externalId2 = 0, $attachmentCategoryId = 0, $src = CommonDefs::MODULE_ADMIN, $pid = 0) { goto hsh1l; FJDfp: return $attachmentId; goto zPcVa; tN7Bx: $attachmentId = $attachmentsModel->attachment_id; goto OvGtE; HV2wU: switch ($src) { case 0: case CommonDefs::MODULE_ADMIN: goto QHWIK; LiIdv: goto DNUtx; goto QoE9_; QHWIK: $attachmentsModel["\x75\163\145\x72\137\x69\144"] = \app\index\service\RequestContext::I()->loginUserId; goto g2X_0; g2X_0: $attachmentsModel["\x75\163\x65\x72\x5f\x74\x79\x70\145"] = CommonDefs::MODULE_ADMIN; goto LiIdv; QoE9_: case CommonDefs::MODULE_PROJECT: goto STyjd; f85TO: $attachmentsModel["\165\163\145\162\x5f\x69\x64"] = intval($p_user["\x69\x64"]); goto eM3H7; STyjd: $p_user = \app\p\service\User::I()->getLoginUser(); goto f85TO; eM3H7: $attachmentsModel["\165\x73\x65\162\x5f\x74\171\160\x65"] = $src; goto vgac2; vgac2: goto DNUtx; goto zlpOc; zlpOc: } goto ZLOtZ; s3TG6: $attachmentsModel->save(); goto tN7Bx; hsh1l: $attachmentsModel = new Attachments(); goto Gl3lH; GwkSn: DNUtx: goto s3TG6; Gl3lH: $attachmentsModel->data(["\157\162\x69\x67\x69\x6e\141\x6c\x5f\156\x61\155\x65" => $originalName, "\x73\141\x76\x65\x5f\x6e\141\x6d\x65" => $saveName, "\x6d\x69\155\145\x5f\x74\171\160\x65" => $mimeType, "\x64\145\x73\x63\162\x69\x70\164\151\157\x6e" => $description, "\x73\151\x7a\x65" => $fileSize, "\141\x74\x74\141\x63\150\x6d\x65\156\164\137\164\171\x70\145" => $attachmentType, "\x65\170\164\x65\162\156\141\154\x5f\151\x64" => $externalId, "\145\170\164\x65\162\x6e\141\154\x5f\x69\x64\62" => intval($externalId2), "\x70\x69\144" => $pid, "\x61\164\x74\x61\143\150\155\145\x6e\x74\137\x63\x61\164\x65\147\x6f\162\171\137\x69\144" => $attachmentCategoryId, "\145\x6e\x74\x65\x72\x65\x64" => Db::raw("\156\x6f\167\x28\51")]); goto HV2wU; OvGtE: Log::notice("\164\x68\x65\x20\x6e\145\x77\40\x61\164\x74\x61\143\150\155\145\x6e\164\40\x69\x64\x3a\x20" . $attachmentId); goto FJDfp; ZLOtZ: Ut5JF: goto GwkSn; zPcVa: } public function getAttaches($attachmentType, $externalId, $externalId2 = 0, $src = CommonDefs::MODULE_ADMIN) { goto Lkm8J; G0nHb: $conditions["\165\163\145\x72\x5f\x74\171\160\145"] = $src; goto heijj; Lkm8J: if (!empty($externalId)) { goto U3t3X; } goto lZNcI; s7Cmx: $attaches = Db::table("\x61\x74\x74\x61\x63\x68\x6d\x65\156\x74\163")->where($conditions)->field("\141\164\164\x61\x63\150\x6d\145\x6e\x74\137\151\x64\x2c\15\12\40\x20\40\x20\40\x20\40\40\40\x20\40\x20\x70\151\144\x2c\15\12\40\40\x20\40\40\40\40\x20\x20\x20\x20\x20\157\x72\151\x67\151\156\141\x6c\137\x6e\141\x6d\145\x2c\15\12\x9\x9\11\163\141\166\x65\137\x6e\141\155\x65\x2c\15\12\x9\11\x9\155\x69\x6d\x65\137\164\x79\x70\145\x2c\xd\12\11\x9\11\x64\145\x73\x63\x72\151\160\164\151\x6f\156\54\xd\12\11\11\11\163\x69\172\x65\x2c\15\xa\x9\x9\11\141\164\164\x61\143\x68\x6d\145\156\164\x5f\x74\171\160\x65\x2c\xd\xa\11\x9\11\145\170\164\145\x72\156\x61\154\137\151\144\x2c\15\xa\x9\x9\x9\x65\x78\x74\x65\x72\156\141\x6c\137\x69\x64\62\54\15\xa\11\11\11\141\164\x74\141\143\x68\x6d\145\x6e\164\137\143\x61\x74\145\x67\157\162\171\x5f\151\144\54\15\12\x9\x9\11\x65\156\x74\145\x72\145\x64\54\15\12\11\x9\11\x75\163\x65\x72\137\x69\x64\x2c\xd\xa\x9\11\11\x75\163\x65\x72\x5f\x74\171\160\145")->order("\141\164\164\141\143\150\x6d\x65\156\x74\137\x69\144", "\144\x65\163\x63")->select(); goto fBrMI; meeYr: $conditions = ["\x61\x74\x74\141\x63\x68\155\x65\x6e\164\x5f\164\171\x70\x65" => $attachmentType, "\x65\x78\164\x65\x72\x6e\x61\154\x5f\x69\144" => $externalId, "\163\164\x61\x74\x75\163" => Defs::ATTACHMENT_OK]; goto M08zO; HNgAQ: d4G0V: goto xyZY9; Klnh5: U3t3X: goto meeYr; heijj: wM3lq: goto s7Cmx; fBrMI: return $attaches; goto rMlvC; AbEoy: $conditions["\x75\x73\x65\162\x5f\x69\x64"] = intval($p_user["\151\144"]); goto G0nHb; lZNcI: return []; goto Klnh5; izg8w: $p_user = \app\p\service\User::I()->getLoginUser(); goto AbEoy; xyZY9: if (!($src == CommonDefs::MODULE_PROJECT)) { goto wM3lq; } goto izg8w; GcLf0: $conditions["\145\x78\x74\x65\x72\156\x61\154\137\x69\144\62"] = $externalId2; goto HNgAQ; M08zO: if (!$externalId2) { goto d4G0V; } goto GcLf0; rMlvC: } public function deleteAttach($attachmentId) { goto Bau44; VycAP: return true; goto Vlu2k; U00Iv: $attachmentId = explode("\54", $attachmentId); goto pKR0Z; BIahG: Attachments::where($where)->setField("\163\164\141\x74\165\163", Defs::ATTACHMENT_DEL); goto VycAP; Xh_li: $where["\x61\164\164\141\x63\150\155\x65\x6e\164\x5f\151\144"] = count($attachmentId) > 1 ? ["\151\x6e", $attachmentId] : $attachmentId[0]; goto BIahG; Bau44: if (!($attachmentId && !is_array($attachmentId))) { goto g_RNX; } goto U00Iv; pKR0Z: g_RNX: goto Xh_li; Vlu2k: } public function deleteAttaches($externalId, $attachmentType) { Db::table("\x61\x74\x74\x61\143\x68\155\x65\x6e\164\x73")->where(["\x61\164\x74\141\143\150\x6d\145\x6e\x74\137\x74\171\160\145" => $attachmentType, "\145\170\x74\x65\162\156\x61\154\x5f\x69\144" => $externalId, "\x73\164\141\x74\x75\163" => Defs::ATTACHMENT_OK])->setField("\163\164\x61\164\165\x73", Defs::ATTACHMENT_DEL); return true; } public function relateAttaches($attachment_id, $external_id, $external_id2 = 0) { goto prpWb; EpDhg: $save["\x65\x78\164\x65\x72\156\x61\x6c\137\151\x64"] = $external_id; goto FeFgG; prpWb: if (!empty($attachment_id)) { goto FarbP; } goto H7sFh; H7sFh: return; goto Yv_1v; zNfAp: Db::table("\x61\164\164\x61\x63\x68\155\145\156\164\x73")->where(["\x61\x74\164\x61\143\150\155\145\156\x74\137\x69\x64" => isset($attachment_id[1]) ? ["\151\156", $attachment_id] : $attachment_id[0]])->update($save); goto lQlDa; FeFgG: if (!$external_id2) { goto LwVRg; } goto YVoaj; YVoaj: $save["\x65\170\164\145\162\156\141\x6c\137\x69\144\x32"] = $external_id2; goto G8O1r; eCI6y: IK8BX: goto EpDhg; Yv_1v: FarbP: goto eKs72; pjRo_: $attachment_id = explode("\54", $attachment_id); goto eCI6y; eKs72: if (is_array($attachment_id)) { goto IK8BX; } goto pjRo_; G8O1r: LwVRg: goto zNfAp; lQlDa: } }
