<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; class LoginLogs extends Base { const LOGIN_USER_ADMIN_TYPE = 1; const LOGIN_USER_PARTNER_TYPE = 2; public static $loginUserTypeDefs = array(self::LOGIN_USER_ADMIN_TYPE => "\xe7\256\xa1\347\x90\x86\xe5\x91\x98", self::LOGIN_USER_PARTNER_TYPE => "\345\x90\x88\xe4\274\231\xe4\272\272"); public static $loginUserTypeHtmlDefs = array(self::LOGIN_USER_ADMIN_TYPE => "\74\x73\160\x61\156\40\143\x6c\141\163\x73\75\42\x62\x61\144\x67\x65\x20\142\141\144\x67\x65\x2d\x70\x72\151\x6d\x61\162\171\42\76\347\xae\xa1\347\220\206\345\221\230\74\x2f\163\160\141\x6e\x3e", self::LOGIN_USER_PARTNER_TYPE => "\x3c\163\x70\141\156\x20\x63\154\141\x73\x73\x3d\x22\142\141\144\x67\x65\40\142\x61\x64\147\x65\x2d\163\165\143\143\x65\x73\163\42\76\xe5\x90\210\344\274\x99\xe4\272\272\74\x2f\163\160\141\x6e\x3e"); protected function __construct() { parent::__construct(); } public function load($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = "\x69\144", $order = "\144\145\x73\x63") { goto vjcK0; rhWUP: $conditions["\165\163\145\x72\x6e\141\155\x65"] = ["\x6c\x69\x6b\145", "\45" . $search["\x75\x73\145\162\x6e\x61\155\145"] . "\45"]; goto DAOW1; n0Z2Y: if ($sort == "\x74\151\x6d\145") { goto rW_YT; } goto ZeWVB; b5cfD: goto lFp5X; goto KM9Cg; dxUbd: if (emptyInArray($search, "\x75\x73\x65\162\156\141\x6d\145")) { goto TQyPJ; } goto rhWUP; G5mIt: $records = Db::table("\x6c\x6f\147\151\156\x5f\x6c\x6f\x67\163")->where($conditions)->order($order)->limit($limit)->field(true)->select(); goto jAIup; jAIup: return ["\164\157\164\141\x6c" => $totalCount, "\x72\157\x77\x73" => $records]; goto OF5CS; pjL_0: $conditions = []; goto dxUbd; ngw72: lFp5X: goto pjL_0; hXTvJ: rW_YT: goto txYM1; ZeWVB: $order = "\x69\x64\40\144\x65\163\143"; goto HRF76; RZjg5: if ($sort == "\151\x64") { goto Vv_IG; } goto n0Z2Y; vjcK0: $limit = ($page - 1) * $rows . "\x2c" . $rows; goto RZjg5; SAPU4: $order = "\151\x64\40" . $order; goto ngw72; FhoUF: q7AkQ: goto b5cfD; DAOW1: TQyPJ: goto OWJMs; OWJMs: $totalCount = Db::table("\154\157\147\151\156\137\154\157\x67\x73")->where($conditions)->count(); goto G5mIt; txYM1: $order = "\164\151\x6d\x65\40" . $order; goto FhoUF; HRF76: goto q7AkQ; goto hXTvJ; KM9Cg: Vv_IG: goto SAPU4; OF5CS: } public function add($username, $userid, $usertype, $useragent, $ip) { Db::table("\x6c\157\x67\x69\x6e\x5f\x6c\x6f\x67\163")->insert(["\165\163\145\x72\x6e\x61\155\145" => $username, "\165\163\145\162\151\144" => $userid, "\165\163\145\x72\x74\171\x70\145" => $usertype, "\x75\x73\145\x72\141\x67\145\x6e\x74" => $useragent, "\x64\x65\166\151\143\145" => Request::instance()->isMobile() ? \app\index\model\Base::AUDIT_LOG_MOBILE_DEVICE : \app\index\model\Base::AUDIT_LOG_DESKTOP_DEVICE, "\151\x70" => $ip, "\164\151\155\x65" => Db::raw("\x6e\x6f\167\50\51")]); } }
