<?php
 namespace app\index\logic; use think\Db; class UserRecord extends Base { public function setRecordUsers($module, $record_id, $user_ids, $primary_users = null) { goto rbBRy; lD16a: EObDL: goto nYHQz; WjlbJ: YvSuH: goto RpKvY; nYHQz: if (!($primary_users && !is_array($primary_users))) { goto YvSuH; } goto r2eS3; r2eS3: $primary_users = explode("\54", $primary_users); goto WjlbJ; GIgnv: p93Ig: goto Qqsju; Qqsju: if (is_array($user_ids)) { goto EObDL; } goto leLjC; yXwrL: if (!empty($user_ids)) { goto p93Ig; } goto sP2FR; RpKvY: $adds = []; goto CdV4B; cntt_: aDEy7: goto ARnOL; xNC0N: foreach ($user_ids as $uid) { $adds[] = ["\155\x6f\x64\165\154\x65" => $module, "\162\145\143\157\162\x64\137\151\144" => $record_id, "\165\163\145\162\x5f\x69\x64" => $uid, "\x70\162\x69\x6d\x61\x72\171" => $primary_users && in_array($uid, $primary_users) ? 1 : 0]; bsBdj: } goto cntt_; leLjC: $user_ids = explode("\x2c", $user_ids); goto lD16a; rbBRy: Db::table("\165\x73\x65\x72\x73\x5f\162\145\x63\157\x72\x64\163")->where(["\155\157\x64\x75\154\x65" => $module, "\x75\163\x65\162\x5f\x69\144" => ["\147\x74", 0], "\162\145\x63\x6f\162\144\137\x69\x64" => $record_id])->delete(); goto yXwrL; ARnOL: Db::table("\x75\x73\x65\x72\163\x5f\x72\x65\x63\157\x72\144\x73")->insertAll($adds); goto hUYhk; CdV4B: $user_ids = array_unique($user_ids); goto xNC0N; sP2FR: return; goto GIgnv; hUYhk: } public function getRecordUsers($module, $record_id) { $users = Db::table("\x75\x73\145\162\x73\137\162\145\143\x6f\x72\144\x73")->where(["\155\x6f\144\x75\154\145" => $module, "\x72\x65\143\157\162\144\x5f\151\144" => $record_id])->column("\162\145\143\157\x72\144\137\151\x64\x2c\x75\x73\x65\x72\137\151\x64\54\x70\162\x69\155\141\162\x79", "\x75\x73\145\x72\x5f\x69\x64"); return $users; } }
