<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs; use app\index\model\FundsCollect as FundsCollectModel; class FundsCollect extends Base { protected function __construct() { parent::__construct(); } public function loadPartners($fundId) { goto keuBA; jsLCP: return ["\x72\157\x77\x73" => $records, "\146\x6f\x6f\x74\145\x72" => [["\x66\x70\x5f\151\144" => 0, "\x6e\x61\155\145" => "\345\220\210\350\256\241\357\xbc\x9a", "\141\x6d\x6f\x75\156\x74" => $totalAmount, "\x61\x63\164\165\141\x6c\x5f\141\x6d\157\165\156\164" => $totalActualAmount]]]; goto E4esz; pshb2: $totalActualAmount = 0; goto xZNp1; IBZ2k: $totalAmount = 0; goto pshb2; xZNp1: foreach ($records as &$record) { goto zkfR4; ND0vu: s5ZkX: goto KJxUu; UzN5Y: if ($actualAmount) { goto s5ZkX; } goto jqalA; B2G5B: goto C0fuc; goto E5lnN; YCriB: $totalActualAmount += $record["\141\x63\x74\x75\x61\154\137\141\155\x6f\165\156\164"]; goto mKoj1; fBgrC: $record["\163\150\x61\x72\x65\137\160\162\157\x70\157\x72\164\151\x6f\156"] = ''; goto B2G5B; mKoj1: yCrWG: goto FkdZQ; e2azY: $fpId = $record["\x66\x70\137\x69\x64"]; goto s1xgT; zkfR4: if ((float) $fundSize) { goto LxRlY; } goto fBgrC; s1xgT: $actualAmount = Db::table("\x66\165\x6e\x64\x73\137\x66\151\156\x61\156\x63\145\x5f\x63\157\x6e\x74\162\x69\x62\x75\x74\x65\x73")->where("\x66\x66\143\x5f\151\x64", "\151\x6e", function ($query) use($fpId) { $query->table("\146\165\156\x64\163\x5f\160\x61\162\164\156\145\162\x73\x5f\x70\x61\151\144")->where("\x66\x70\x5f\x69\144", $fpId)->field("\146\x66\143\x5f\151\x64"); })->sum("\x61\155\x6f\x75\156\164"); goto UzN5Y; KJxUu: $record["\141\143\x74\165\141\x6c\x5f\141\x6d\157\x75\156\x74"] = sprintf("\x25\56\62\x66", $actualAmount); goto RFLtU; tNPCm: $record["\163\150\141\x72\145\x5f\160\162\157\160\x6f\162\164\151\x6f\x6e"] = round($record["\141\155\157\x75\156\x74"] / $fundSize * 100, 2) . "\x25"; goto sghnj; sghnj: C0fuc: goto e2azY; E5lnN: LxRlY: goto tNPCm; RFLtU: $totalAmount += $record["\141\x6d\x6f\165\156\164"]; goto YCriB; jqalA: $actualAmount = 0.0; goto ND0vu; FkdZQ: } goto o9XzP; o9XzP: JH5pj: goto jsLCP; keuBA: $records = Db::table("\146\x75\x6e\144\163\137\160\141\162\164\156\x65\162\163")->alias("\106\x50")->join("\160\141\x72\x74\x6e\145\x72\163\x20\x50", "\106\120\56\160\137\151\144\x3d\120\x2e\x70\x5f\151\x64", "\114\x45\x46\124")->where("\106\120\x2e\146\x75\x6e\x64\137\x69\x64", $fundId)->order("\x50\56\164\171\160\145\40\x64\x65\163\x63")->field("\x46\x50\x2e\52\x2c\120\56\156\141\x6d\x65\x2c\x50\56\164\171\x70\x65")->select(); goto TCZTo; TCZTo: $fundSize = Db::table("\146\x75\x6e\x64\163")->where("\146\x75\x6e\x64\x5f\151\x64", $fundId)->value("\163\151\x7a\x65"); goto IBZ2k; E4esz: } public function loadPartnersPaid($fpId) { $records = Db::table("\x66\x75\x6e\x64\163\x5f\160\141\162\164\x6e\145\x72\x73\137\x70\x61\x69\x64")->where("\146\x70\137\151\x64", $fpId)->field(true)->select(); return $records; } public function getPartnerInfos($fpId) { $infos = Db::table("\146\165\x6e\x64\x73\137\x70\141\162\164\x6e\x65\x72\163")->where("\x66\x70\x5f\151\144", $fpId)->field(true)->find(); return $infos; } public function getPartnerPaidInfos($fpPaidId) { $infos = Db::table("\146\x75\156\x64\x73\137\160\141\x72\x74\156\x65\162\163\x5f\160\x61\151\144")->where("\146\x70\x5f\160\x61\151\x64\137\x69\144", $fpPaidId)->field(true)->find(); return $infos; } public function addPartner($fundId, $infos) { goto Jjydq; L8GD0: return true; goto A588s; N3zYm: Db::table("\x66\165\x6e\x64\x73\x5f\160\x61\x72\164\x6e\x65\162\x73")->insert($infos); goto L8GD0; Jjydq: $infos["\x66\165\x6e\x64\x5f\x69\144"] = $fundId; goto N3zYm; A588s: } public function addPartnerPaid($fpId, $infos) { goto qacDL; NqNEc: return true; goto o9OXa; QT1S4: $datas["\x66\x66\143\137\151\144"] = !emptyInArray($infos, "\x66\146\x63\137\151\x64") ? $infos["\x66\x66\x63\x5f\151\x64"] : 0; goto Y75Zz; pg6Ff: $datas["\146\160\137\151\144"] = $fpId; goto QT1S4; qacDL: $datas = []; goto pg6Ff; Y75Zz: Db::table("\x66\165\x6e\144\x73\137\x70\141\162\164\156\x65\162\163\x5f\160\x61\151\x64")->insert($datas); goto NqNEc; o9OXa: } public function editPartner($fpId, $infos) { goto gSOwI; KvkzO: Db::table("\x66\165\156\x64\x73\137\x70\141\x72\164\x6e\x65\x72\163")->where("\146\x70\137\151\144", $fpId)->update($datas); goto SwyY9; SwyY9: return true; goto ZJm8M; egA4B: $datas["\141\155\157\165\156\164"] = !emptyInArray($infos, "\x61\x6d\157\x75\156\x74") ? $infos["\x61\x6d\157\x75\156\x74"] : 0; goto KvkzO; gSOwI: $datas = []; goto egA4B; ZJm8M: } public function editPartnerPaid($fpPaidId, $infos) { return true; } public function exitPartner($fpId) { Db::table("\x66\x75\x6e\x64\163\137\x70\x61\162\164\x6e\x65\162\x73")->where("\146\160\137\x69\144", $fpId)->update(["\163\x74\x61\x74\x75\163" => Defs::FUND_PARTNER_EXIT_STATUS]); return true; } public function enterPartner($fpId) { Db::table("\x66\x75\156\x64\163\x5f\160\x61\162\164\x6e\145\x72\163")->where("\x66\x70\137\151\x64", $fpId)->update(["\163\164\141\x74\165\x73" => Defs::FUND_PARTNER_ACTIVE_STATUS]); return true; } public function deletePartner($fpId) { goto KR_3u; ub_9c: PbKLv: goto bRtY5; oy4kO: foreach ($fpPaidIds as $fpPaidId) { $this->deletePartnerPaid($fpPaidId); RGxHQ: } goto ub_9c; KR_3u: $fpPaidIds = Db::table("\146\165\156\x64\x73\137\160\x61\x72\164\156\x65\x72\x73\137\x70\x61\151\x64")->where("\146\x70\137\151\x64", $fpId)->column("\146\x70\137\160\141\151\144\137\x69\144"); goto oy4kO; LbC42: return true; goto JI4TR; bRtY5: Db::table("\146\x75\156\144\x73\137\x70\141\162\164\156\x65\162\x73")->where("\x66\x70\137\151\144", $fpId)->delete(); goto LbC42; JI4TR: } public function deletePartnerPaid($fpPaidId) { goto GeLBb; GeLBb: $ffcId = Db::table("\x66\165\x6e\x64\163\x5f\160\x61\162\x74\156\145\x72\163\x5f\160\141\x69\144")->where("\x66\160\x5f\160\141\151\144\x5f\x69\144", $fpPaidId)->value("\146\x66\x63\x5f\151\x64"); goto cwF1x; bKIGE: Db::table("\x66\165\x6e\144\163\137\160\141\162\x74\x6e\x65\x72\163\x5f\160\141\x69\x64")->where("\146\160\x5f\x70\x61\x69\x64\x5f\151\x64", $fpPaidId)->delete(); goto kr8TC; cwF1x: $fundsFinanceLogic = \app\index\logic\FundsFinance::newObj(); goto EL6To; kr8TC: return true; goto cJXbF; EL6To: $fundsFinanceLogic->deleteFinanceContribute($ffcId); goto bKIGE; cJXbF: } public function getInfos($fundId) { $infos = Db::table("\146\165\x6e\x64\x73\137\143\157\154\154\145\143\x74")->where("\x66\165\156\144\x5f\x69\144", $fundId)->field(true)->find(); return $infos; } public function savePlanInfos($fundId, $infos) { goto Pi4F_; JxNS8: $infos["\x66\x75\x6e\144\x5f\x69\144"] = $fundId; goto JWJ8t; staX0: return true; goto PBipw; f3Qf6: $model->save($infos); goto cZXu0; aYW7I: iGAmo: goto f3Qf6; BOXAV: if ($model) { goto iGAmo; } goto JxNS8; RBEfM: goto D3tn5; goto aYW7I; ReLPc: $model->save(); goto RBEfM; JWJ8t: $model = model("\x46\165\156\144\x73\103\x6f\154\x6c\x65\143\x74"); goto ALjE3; cZXu0: D3tn5: goto staX0; ALjE3: $model->data($infos); goto ReLPc; Pi4F_: $model = FundsCollectModel::get($fundId); goto BOXAV; PBipw: } public function saveBusinessRegInfos($fundId, $infos) { goto JQ2P9; rtBL0: QGwAl: goto d0XIS; jLLDw: $infos["\146\x75\x6e\x64\137\151\144"] = $fundId; goto YEziv; wXQaF: goto QGwAl; goto dGiA9; XcnbI: $model->data($infos); goto W6M2b; JQ2P9: $model = FundsCollectModel::get($fundId); goto SQa8e; KEpJ5: $model->save($infos); goto rtBL0; YEziv: $model = model("\106\x75\156\144\163\103\x6f\x6c\154\x65\143\x74"); goto XcnbI; d0XIS: return true; goto Y7aKz; W6M2b: $model->save(); goto wXQaF; SQa8e: if ($model) { goto OY_4m; } goto jLLDw; dGiA9: OY_4m: goto KEpJ5; Y7aKz: } public function saveTaxInfos($fundId, $infos) { goto MVsaZ; Nop6i: UC7Gl: goto V6Shx; V6Shx: return true; goto EmWRJ; yHvMV: if ($model) { goto tJXba; } goto oHSJ2; sBZGZ: tJXba: goto YGEu3; tAG9E: $model->save(); goto tjVN9; MVsaZ: $model = FundsCollectModel::get($fundId); goto yHvMV; YGEu3: $model->save($infos); goto Nop6i; o0Ark: $model->data($infos); goto tAG9E; vTjMx: $model = model("\106\x75\x6e\x64\163\x43\157\x6c\x6c\145\143\x74"); goto o0Ark; tjVN9: goto UC7Gl; goto sBZGZ; oHSJ2: $infos["\x66\165\x6e\144\x5f\151\x64"] = $fundId; goto vTjMx; EmWRJ: } public function saveProtocolInfos($fundId, $infos) { goto EY83y; E9iTT: return true; goto OFGYi; nr1T5: z6qzs: goto hmxy7; xx4MZ: $model->save(); goto w_YkB; w_YkB: goto DAAOc; goto nr1T5; hmxy7: $model->save($infos); goto mtLET; sLQ_Z: if ($model) { goto z6qzs; } goto rI1p7; rI1p7: $infos["\x66\x75\x6e\x64\137\x69\x64"] = $fundId; goto efjhZ; TxCUW: $model->data($infos); goto xx4MZ; efjhZ: $model = model("\x46\x75\x6e\x64\x73\x43\x6f\154\x6c\145\x63\x74"); goto TxCUW; EY83y: $model = FundsCollectModel::get($fundId); goto sLQ_Z; mtLET: DAAOc: goto E9iTT; OFGYi: } public function saveHostingPlanInfos($fundId, $infos) { goto AgFat; oR3Pn: Lxm84: goto IodpW; grTYl: goto Lxm84; goto lLVvs; v2w8p: if ($model) { goto Tuq7I; } goto LBhg3; lLVvs: Tuq7I: goto yQTPt; yQTPt: $model->save($infos); goto oR3Pn; gN5Ep: $model->data($infos); goto CjGl9; AgFat: $model = FundsCollectModel::get($fundId); goto v2w8p; xMBp4: $model = model("\x46\165\x6e\x64\163\x43\x6f\x6c\x6c\145\143\x74"); goto gN5Ep; CjGl9: $model->save(); goto grTYl; LBhg3: $infos["\x66\x75\156\144\137\151\144"] = $fundId; goto xMBp4; IodpW: return true; goto yKdVP; yKdVP: } public function saveFilingInfos($fundId, $infos) { goto LgA8U; M39S4: $model->data($infos); goto gQIxZ; SatTC: $model->save($infos); goto qOshD; yZ2K5: return true; goto n0orM; gQIxZ: $model->save(); goto uY8i8; F9VWB: if ($model) { goto R5Nz0; } goto bc3tq; Yb91b: $model = model("\x46\x75\x6e\144\x73\103\157\154\154\x65\x63\x74"); goto M39S4; qOshD: A2I97: goto yZ2K5; bc3tq: $infos["\x66\x75\x6e\144\x5f\151\x64"] = $fundId; goto Yb91b; LgA8U: $model = FundsCollectModel::get($fundId); goto F9VWB; TFwPU: R5Nz0: goto SatTC; uY8i8: goto A2I97; goto TFwPU; n0orM: } public function saveDeliveryInfos($fundId, $infos) { goto TSeAZ; sU6ZB: $model->save($infos); goto Zwcj1; Zwcj1: ea2t7: goto PbLAg; uWRVZ: $model = model("\x46\x75\x6e\144\163\103\157\x6c\154\x65\143\164"); goto Sdh1v; Z9K6d: $model->save(); goto hI7_x; v8T_8: R763h: goto sU6ZB; TSeAZ: $model = FundsCollectModel::get($fundId); goto WFFHz; PbLAg: return true; goto cf4nS; Sdh1v: $model->data($infos); goto Z9K6d; WFFHz: if ($model) { goto R763h; } goto MYkFd; hI7_x: goto ea2t7; goto v8T_8; MYkFd: $infos["\x66\x75\156\x64\x5f\151\x64"] = $fundId; goto uWRVZ; cf4nS: } }
